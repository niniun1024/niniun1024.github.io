<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"niniun1024.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="niniun1024&#39;s blog">
<meta property="og:type" content="website">
<meta property="og:title" content="niniun1024&#39;s blog">
<meta property="og:url" content="http://niniun1024.github.io/page/2/index.html">
<meta property="og:site_name" content="niniun1024&#39;s blog">
<meta property="og:description" content="niniun1024&#39;s blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="niniun1024">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://niniun1024.github.io/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>niniun1024's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">niniun1024's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2021/06/08/%E9%9B%86%E6%88%90%E7%AC%AC%E4%B8%89%E6%96%B9web%E5%86%85%E5%AE%B9%E7%9A%84%E5%9B%9B%E7%A7%8D%E6%96%B9%E5%BC%8F%EF%BC%9Awebview%E3%80%81browserView%E3%80%81iframe%E3%80%81browserWindow/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/06/08/%E9%9B%86%E6%88%90%E7%AC%AC%E4%B8%89%E6%96%B9web%E5%86%85%E5%AE%B9%E7%9A%84%E5%9B%9B%E7%A7%8D%E6%96%B9%E5%BC%8F%EF%BC%9Awebview%E3%80%81browserView%E3%80%81iframe%E3%80%81browserWindow/" class="post-title-link" itemprop="url">集成第三方web内容的四种方式：webview、browserView、iframe、browserWindow</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-06-08 22:24:16 / 修改时间：22:27:55" itemprop="dateCreated datePublished" datetime="2021-06-08T22:24:16+08:00">2021-06-08</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Electron/" itemprop="url" rel="index"><span itemprop="name">Electron</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="browserWindow"><a href="#browserWindow" class="headerlink" title="browserWindow"></a>browserWindow</h1><blockquote>
<p>文档：<a target="_blank" rel="noopener" href="https://www.electronjs.org/docs/api/browser-window#browserwindow">https://www.electronjs.org/docs/api/browser-window#browserwindow</a></p>
</blockquote>
<p>新开Electron窗口，拥有所有electron浏览器窗口的方法和属性，另外可打开模态窗口（禁用父窗口的子窗口，创建模态窗口必须设置 parent 和 modal 选项）</p>
<h1 id="webview"><a href="#webview" class="headerlink" title="webview"></a>webview</h1><blockquote>
<p>文档：<a target="_blank" rel="noopener" href="https://www.electronjs.org/docs/api/webview-tag#webview-tag">https://www.electronjs.org/docs/api/webview-tag#webview-tag</a></p>
</blockquote>
<p>使用webview标签需在主窗口webPreferences中设置webviewTag:true，另外webview内嵌页面调用node和electron模块需进行如下设置：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  主窗口</span></span><br><span class="line">webPreferences: &#123;</span><br><span class="line">  nodeIntegration: <span class="literal">true</span>,</span><br><span class="line">  enableRemoteModule: <span class="literal">true</span>,</span><br><span class="line">  webviewTag: <span class="literal">true</span>,</span><br><span class="line">  contextIsolation: <span class="literal">false</span>   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 标签（display:flex;是为了使内部渲染后的网页视图窗口铺满webview容器）</span></span><br><span class="line">&lt;webview id=<span class="string">&quot;wb&quot;</span> style=<span class="string">&quot;display:flex;width:500px;height:500px&quot;</span> src=<span class="string">&quot;http://www.baidu.com&quot;</span> webpreferences=<span class="string">&quot;contextIsolation=false&quot;</span>  nodeintegration=<span class="string">&quot;true&quot;</span> enableremotemodule=<span class="string">&quot;true&quot;</span>  &gt;&lt;/webview&gt;</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong>electron12把contextIsolation默认值改为true,虽然主窗口中已设置false,但是webview标签内需再次设置webpreferences=”contextIsolation=false”，另外主窗口和webview的nodeintegration和enableremotemodule需同时设为true，才能成功使内嵌页调用node和electron模块</p>
<p>webview可以监听DOM加载的开始与结束，并打开独立控制台</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webview = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;webview&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> indicator = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;.indicator&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> loadstart = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  indicator.innerText = <span class="string">&#x27;loading...&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> loadstop = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  indicator.innerText = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  webview.openDevTools();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">webview.addEventListener(<span class="string">&#x27;dom-ready&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  webview.openDevTools()</span><br><span class="line">&#125;)</span><br><span class="line">    </span><br><span class="line">webview.addEventListener(<span class="string">&#x27;did-start-loading&#x27;</span>, loadstart)</span><br><span class="line">webview.addEventListener(<span class="string">&#x27;did-stop-loading&#x27;</span>, loadstop)</span><br></pre></td></tr></table></figure>
<p>src 属性除了接受url地址，还可以接受数据 URL, 如 data:text/plain, Hello, world!。<br>webview拥有原生浏览器的前进、后退、停止加载、复制、粘贴、剪切、查找、全选、替换、打印、放大、缩小等功能接口，注入CSS和JS代码的方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;webview src=<span class="string">&quot;https://www.github.com/&quot;</span> preload=<span class="string">&quot;./test.js&quot;</span>&gt;&lt;/webview&gt;</span><br></pre></td></tr></table></figure>
<p>preload脚本的URL的协议必须是 file: asar:二者之一，因为在访客页中，它是通过“内部”的 require 去加载的。当访客页没有 node integration ，这个脚本仍然有能力去访问所有的 Node APIs, 但是当这个脚本执行执行完成之后，通过Node 注入的全局对象（global objects）将会被删除。</p>
<p>可通过httpreferrer设置嵌入页面的referrer，useragent设置嵌入页面的useragent，disablewebsecurity关闭web安全限制（默认true）</p>
<p><font color=#f00>Electron的 webview 标签基于 Chromium webview，后者正在经历巨大的架构变化。 这将影响 webview 的稳定性，包括呈现、导航和事件路由。 我们目前建议不使用 webview 标签，并考虑其他替代方案，如 iframe ，Electron的 BrowserView 或完全避免嵌入内容的架构。</font></p>
<h1 id="browserView"><a href="#browserView" class="headerlink" title="browserView"></a>browserView</h1><blockquote>
<p>文档：<a target="_blank" rel="noopener" href="https://www.electronjs.org/docs/api/browser-view#browserview">https://www.electronjs.org/docs/api/browser-view#browserview</a></p>
</blockquote>
<p>browserView提供的接口功能较少且多为实验性功能，browserView位置是相对于父窗口偏移，窗口直接覆盖在父窗口之上。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> win = <span class="keyword">new</span> BrowserWindow(&#123;</span><br><span class="line">  width: <span class="number">1000</span>,</span><br><span class="line">  height: <span class="number">650</span></span><br><span class="line">&#125;)</span><br><span class="line">win.loadFile(<span class="string">&#x27;index.html&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> view = <span class="keyword">new</span> BrowserView(); <span class="comment">//创建view窗口</span></span><br><span class="line">win.setBrowserView(view); <span class="comment">// 将子窗口view嵌入到父窗口win中</span></span><br><span class="line">view.setBounds(&#123; <span class="attr">x</span>: <span class="number">50</span>, <span class="attr">y</span>: <span class="number">50</span>, <span class="attr">width</span>: <span class="number">300</span>, <span class="attr">height</span>: <span class="number">300</span> &#125;); <span class="comment">// 设置view的宽高，相对父窗口的位置</span></span><br><span class="line">view.webContents.loadURL(<span class="string">&#x27;https://www.baidu.com&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h1 id="iframe"><a href="#iframe" class="headerlink" title="iframe"></a>iframe</h1><p>Iframe 在 Electron 中的行为与普通浏览器中类似。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>1、browserWindow适用于新开窗口，位置脱离主窗口，包含丰富的功能接口，拥有调用node和electron模块的能力<br>2、webview可以与页面布局融合在一起，拥有丰富的浏览器功能接口，拥有调用node和electron模块的能力，不过需注意内核架构更新变化对它的影响<br>3、broswerView适用于简单嵌入第三方页面，位置相对于父窗口，直接覆盖在父窗口之上，为实验性功能<br>4、iframe适用场景同浏览器中iframe</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2021/06/08/vue3%E4%B8%8Evue-Router4%E4%B8%8BKeep-alive%E8%B8%A9%E5%9D%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/06/08/vue3%E4%B8%8Evue-Router4%E4%B8%8BKeep-alive%E8%B8%A9%E5%9D%91/" class="post-title-link" itemprop="url">vue3与vue-Router4下Keep-alive踩坑</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-06-08 22:10:11" itemprop="dateCreated datePublished" datetime="2021-06-08T22:10:11+08:00">2021-06-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-06-09 16:39:01" itemprop="dateModified" datetime="2021-06-09T16:39:01+08:00">2021-06-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Vue2与Vue3 keep-alive的使用区别是Vue2在router-view标签外层，Vue3在router-view标签内</p>
<h1 id="通过include或exclude匹配缓存路由"><a href="#通过include或exclude匹配缓存路由" class="headerlink" title="通过include或exclude匹配缓存路由"></a>通过include或exclude匹配缓存路由</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// include 名称对应的是组件的name值</span></span><br><span class="line">&lt;router-view v-slot=<span class="string">&quot;&#123; Component &#125;&quot;</span>&gt;</span><br><span class="line">  &lt;keep-alive include=<span class="string">&quot;AllGame, MyFavorite&quot;</span>&gt;</span><br><span class="line">    &lt;component <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;view&quot;</span> :is=<span class="string">&quot;Component&quot;</span> /&gt;</span><br><span class="line">  &lt;/keep-alive&gt;</span><br><span class="line">&lt;/router-view&gt;</span><br></pre></td></tr></table></figure>

<h1 id="通过路由配置meta-keepAlive匹配缓存页面"><a href="#通过路由配置meta-keepAlive匹配缓存页面" class="headerlink" title="通过路由配置meta.keepAlive匹配缓存页面"></a>通过路由配置meta.keepAlive匹配缓存页面</h1><p>实际测试发现v-if=”route.meta.keepAlive”放在keep-alive标签或者外层标签都不生效，keep-alive内判断可生效</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;router-view v-slot=<span class="string">&quot;&#123; Component, route &#125;&quot;</span>&gt;</span><br><span class="line">  &lt;keep-alive&gt;</span><br><span class="line">    &lt;component v-<span class="keyword">if</span>=<span class="string">&quot;route.meta.keepAlive&quot;</span> :is=<span class="string">&quot;Component&quot;</span> :key=<span class="string">&quot;route.path&quot;</span>/&gt;</span><br><span class="line">  &lt;/keep-alive&gt;</span><br><span class="line">  &lt;component  v-<span class="keyword">if</span>=<span class="string">&quot;!route.meta.keepAlive&quot;</span> :is=<span class="string">&quot;Component&quot;</span> :key=<span class="string">&quot;route.path&quot;</span>/&gt;</span><br><span class="line">&lt;/router-view&gt;</span><br><span class="line">  </span><br></pre></td></tr></table></figure>
<blockquote>
<p>参考资料<br><a target="_blank" rel="noopener" href="https://next.router.vuejs.org/api/#route">https://next.router.vuejs.org/api/#route</a></p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2021/05/16/Vue3%E4%B8%AD%E8%AE%BE%E7%BD%AE%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E3%80%81%E6%96%B9%E6%B3%95%E3%80%81%E6%8F%92%E4%BB%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/05/16/Vue3%E4%B8%AD%E8%AE%BE%E7%BD%AE%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E3%80%81%E6%96%B9%E6%B3%95%E3%80%81%E6%8F%92%E4%BB%B6/" class="post-title-link" itemprop="url">Vue3中设置全局变量、方法、插件</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-05-16 15:53:28 / 修改时间：16:13:31" itemprop="dateCreated datePublished" datetime="2021-05-16T15:53:28+08:00">2021-05-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="设置全局变量"><a href="#设置全局变量" class="headerlink" title="设置全局变量"></a>设置全局变量</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App.vue:</span></span><br><span class="line">app.config.globalProperties.ver = <span class="string">&#x27;123332&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组件引用</span></span><br><span class="line"><span class="keyword">import</span> &#123; getCurrentInstance &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; proxy&#125; = getCurrentInstance();</span><br><span class="line">  <span class="keyword">let</span> ver = proxy.ver</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ver</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="挂载全局方法"><a href="#挂载全局方法" class="headerlink" title="挂载全局方法"></a>挂载全局方法</h1><p><strong>方法一：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App.vue</span></span><br><span class="line"><span class="keyword">import</span> test <span class="keyword">from</span> <span class="string">&#x27;./plugin/test&#x27;</span></span><br><span class="line">app.config.globalProperties.test= test</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组件引用</span></span><br><span class="line"><span class="keyword">import</span> &#123; getCurrentInstance &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line"><span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; proxy &#125; = getCurrentInstance();</span><br><span class="line">  <span class="keyword">let</span> $test = proxy.test</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    $test</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, </span><br></pre></td></tr></table></figure>

<p><strong>方法二（provide,inject）：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// App.vue</span></span><br><span class="line"><span class="keyword">const</span> toast= <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;ccccc&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line">app.provide(<span class="string">&#x27;toast&#x27;</span>,toast)</span><br><span class="line"><span class="comment">// 组件引用</span></span><br><span class="line"><span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;  </span><br><span class="line">  <span class="keyword">const</span> toast =  inject(<span class="string">&#x27;toast&#x27;</span>)  </span><br><span class="line">  <span class="keyword">return</span> &#123;  </span><br><span class="line">    toast</span><br><span class="line">  &#125;  </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><strong>方法三：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> toast <span class="keyword">from</span> <span class="string">&#x27;./plugin/toast/index&#x27;</span></span><br><span class="line">app.use(toast);</span><br><span class="line"></span><br><span class="line"><span class="comment">// plugin/toast/index.js</span></span><br><span class="line"><span class="keyword">import</span> toast <span class="keyword">from</span> <span class="string">&#x27;./toast&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  version: <span class="string">&#x27;1.0.0&#x27;</span>,</span><br><span class="line">  author: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  install: <span class="function"><span class="keyword">function</span> (<span class="params">Vue</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// toast Fn</span></span><br><span class="line">    Vue.config.globalProperties.$toast = toast;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// plugin/toast/toast.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="function"><span class="title">show</span>(<span class="params">msg</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(msg)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 组件调用</span></span><br><span class="line"><span class="built_in">this</span>.$toast.show(<span class="string">&#x27;toast message&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="挂载全局插件"><a href="#挂载全局插件" class="headerlink" title="挂载全局插件"></a>挂载全局插件</h1><p><strong>方法一（标签调用）</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> test <span class="keyword">from</span> <span class="string">&#x27;./plugin/test.vue&#x27;</span></span><br><span class="line">app.component(<span class="string">&#x27;test&#x27;</span>, test)</span><br><span class="line"></span><br><span class="line"><span class="comment">//  页面中无需引入，直接使用</span></span><br><span class="line">&lt;test /&gt;</span><br></pre></td></tr></table></figure>

<p><strong>方法二（方法调用）</strong><br>main.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> toast <span class="keyword">from</span> <span class="string">&#x27;./plugin/toast/index&#x27;</span></span><br><span class="line">app.use(toast);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>plugin/toast/index</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createVNode, render &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> toast <span class="keyword">from</span> <span class="string">&#x27;./toast.vue&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  install: <span class="function">(<span class="params">Vue</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> MyComponent = createVNode(</span><br><span class="line">      toast,</span><br><span class="line">      &#123;&#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">default</span>: <span class="function">() =&gt;</span> createVNode(),</span><br><span class="line">      &#125;</span><br><span class="line">    )</span><br><span class="line">    MyComponent.appContext = Vue._context;</span><br><span class="line">    render(MyComponent, <span class="built_in">document</span>.body);</span><br><span class="line">    <span class="comment">// MyComponent.component.ctx.setShow = false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> $toast = &#123;</span><br><span class="line">      <span class="function"><span class="title">show</span>(<span class="params">opts = &#123;&#125;</span>)</span> &#123;</span><br><span class="line">        MyComponent.component.ctx.show(opts)</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="function"><span class="title">hide</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        MyComponent.component.ctx.hide()</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Vue.config.globalProperties.$toast = $toast</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>plugin/toast/toast.vue</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;toast&quot;</span> v-<span class="keyword">if</span>=<span class="string">&quot;isShow&quot;</span>&gt;&#123;&#123; msg &#125;&#125; &lt;span <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;&quot;</span> @click=<span class="string">&quot;hide&quot;</span>&gt;X&lt;<span class="regexp">/span&gt;&lt;/</span>div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name: <span class="string">&#x27;Toast&#x27;</span>,</span><br><span class="line">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      isShow: <span class="literal">false</span>,</span><br><span class="line">      msg: <span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods:&#123;</span><br><span class="line">    <span class="function"><span class="title">show</span>(<span class="params">opts</span>)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.msg = opts.msg;</span><br><span class="line">      <span class="built_in">this</span>.isShow = <span class="literal">true</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">hide</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.isShow = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">.toast&#123;</span><br><span class="line">  position: fixed;</span><br><span class="line">  background-color: red;</span><br><span class="line">  left: <span class="number">0</span>;</span><br><span class="line">  top: <span class="number">0</span>;</span><br><span class="line">  width: <span class="number">100</span>%;</span><br><span class="line">  text-align: center;</span><br><span class="line">  line-height: 28px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>

<p>组件调用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.$toast.show(&#123;<span class="attr">msg</span>: <span class="string">&#x27;toast show&#x27;</span>&#125;);</span><br></pre></td></tr></table></figure>



      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2021/05/15/%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%B7%A5%E5%85%B7prettier%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/05/15/%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%B7%A5%E5%85%B7prettier%E4%BD%BF%E7%94%A8/" class="post-title-link" itemprop="url">项目代码格式化工具prettier使用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-05-15 15:47:01 / 修改时间：15:57:06" itemprop="dateCreated datePublished" datetime="2021-05-15T15:47:01+08:00">2021-05-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/" itemprop="url" rel="index"><span itemprop="name">工具使用</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>多人合作时使项目代码风格保持统一，可使用prietter插件。</p>
<h1 id="命令格式化"><a href="#命令格式化" class="headerlink" title="命令格式化"></a>命令格式化</h1><p>1、全局安装</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --<span class="built_in">global</span> prettier</span><br></pre></td></tr></table></figure>
<p>2、在项目目录下配置规则文件.prettierrc.js和忽略规则文件.prettierignore<br>.prettierrc.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// 字符串使用单引号</span></span><br><span class="line">  singleQuote: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// 每行末尾自动添加分号</span></span><br><span class="line">  semi: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// tab缩进大小,默认为2</span></span><br><span class="line">  tabWidth: <span class="number">2</span>,</span><br><span class="line">  <span class="comment">// 使用tab缩进，默认false</span></span><br><span class="line">  useTabs: <span class="literal">false</span>,</span><br><span class="line">  <span class="comment">// 对象中打印空格 默认true</span></span><br><span class="line">  <span class="comment">// true: &#123; foo: bar &#125;</span></span><br><span class="line">  <span class="comment">// false: &#123;foo: bar&#125;</span></span><br><span class="line">  bracketSpacing: <span class="literal">true</span>,</span><br><span class="line">  <span class="comment">// 箭头函数参数括号 默认avoid 可选 avoid| always,只有一个参数的箭头函数的参数是否带圆括号（默认avoid不带）</span></span><br><span class="line">  <span class="comment">// avoid 能省略括号的时候就省略 例如x =&gt; x</span></span><br><span class="line">  <span class="comment">// always 总是有括号</span></span><br><span class="line">  arrowParens: <span class="string">&#x27;avoid&#x27;</span>,</span><br><span class="line">  <span class="comment">// 换行长度，默认80</span></span><br><span class="line">  printWidth: <span class="number">210</span>,</span><br><span class="line">  <span class="string">&quot;endOfLine&quot;</span>: <span class="string">&quot;lf&quot;</span>,</span><br><span class="line">  <span class="comment">// 设置为true时,将多行JSX元素的 &gt; 放在最后一行的末尾，而不是单独放在下一行</span></span><br><span class="line">  jsxBracketSameLine: <span class="literal">false</span>,</span><br><span class="line">  <span class="comment">// 数组、对象最后一个元素的尾逗号</span></span><br><span class="line">  trailingComma: <span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">  <span class="comment">//  HTML 文件空格敏感度</span></span><br><span class="line">  htmlWhitespaceSensitivity: <span class="string">&#x27;ignore&#x27;</span>,</span><br><span class="line">  <span class="comment">// 选项可以开启保存时自动format</span></span><br><span class="line">  <span class="comment">// editor.formatOnSave: true</span></span><br><span class="line">  overrides: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;files&quot;</span>: [<span class="string">&quot;*.html&quot;</span>],</span><br><span class="line">      <span class="string">&quot;options&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;parser&quot;</span>: <span class="string">&quot;html&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;files&quot;</span>: [<span class="string">&quot;*.css&quot;</span>],</span><br><span class="line">      <span class="string">&quot;options&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;parser&quot;</span>: <span class="string">&quot;css&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;files&quot;</span>: [<span class="string">&quot;*.less&quot;</span>],</span><br><span class="line">      <span class="string">&quot;options&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;parser&quot;</span>: <span class="string">&quot;less&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>.prettierignore</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># .prettierignore</span><br><span class="line"></span><br><span class="line">*.min.js</span><br><span class="line">/node_modules</span><br><span class="line">/dist</span><br><span class="line"># OS</span><br><span class="line">.DS_Store</span><br><span class="line">.idea</span><br><span class="line">.editorconfig</span><br><span class="line">.npmrc</span><br><span class="line">package-lock.json</span><br><span class="line"># Ignored suffix</span><br><span class="line">*.log</span><br><span class="line">*.md</span><br><span class="line">*.svg</span><br><span class="line">*.png</span><br><span class="line">*.jpg</span><br><span class="line">*ignore</span><br><span class="line">## Built-files</span><br><span class="line">.cache</span><br><span class="line">dist</span><br></pre></td></tr></table></figure>

<p>3、执行命令</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 指定文件格式化</span></span><br><span class="line">prettier --config  --write ./src/a.js</span><br><span class="line"></span><br><span class="line"><span class="comment">// 指定目录下所有JS文件</span></span><br><span class="line">prettier --config  --write ./src<span class="comment">/*.js</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">// 指定目录格式化</span></span><br><span class="line"><span class="comment">prettier --config  --write ./src/**</span></span><br></pre></td></tr></table></figure>

<p>另外，prettier可与编辑集成。</p>
<blockquote>
<p>参考资料：<br><a target="_blank" rel="noopener" href="https://prettier.io/docs/en/install.html">https://prettier.io/docs/en/install.html</a></p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2021/03/24/Electron%E4%B9%8B%E4%B8%BB%E8%BF%9B%E7%A8%8B%E4%B8%8E%E6%B8%B2%E6%9F%93%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/24/Electron%E4%B9%8B%E4%B8%BB%E8%BF%9B%E7%A8%8B%E4%B8%8E%E6%B8%B2%E6%9F%93%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1/" class="post-title-link" itemprop="url">Electron之主进程与渲染进程通信</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-03-24 19:33:27 / 修改时间：19:34:03" itemprop="dateCreated datePublished" datetime="2021-03-24T19:33:27+08:00">2021-03-24</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Electron/" itemprop="url" rel="index"><span itemprop="name">Electron</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="主进程向渲染进程发送消息"><a href="#主进程向渲染进程发送消息" class="headerlink" title="主进程向渲染进程发送消息"></a>主进程向渲染进程发送消息</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 主进程</span></span><br><span class="line">win.webContents.send(<span class="string">&#x27;mainMsg&#x27;</span>, <span class="string">&#x27;hello&#x27;</span>)   <span class="comment">// 主进程向渲染进程发送异步消息</span></span><br><span class="line">ipcRenderer.sendSync()      <span class="comment">// 发布同步消息</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 渲染进程</span></span><br><span class="line"><span class="keyword">const</span> &#123; ipcRenderer &#125; = <span class="built_in">window</span>.require(<span class="string">&#x27;electron&#x27;</span>);</span><br><span class="line">ipcRenderer.on(<span class="string">&#x27;mainMsg&#x27;</span>, <span class="function">(<span class="params">event, message</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;主进程通知渲染进程：&quot;</span> + message)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h1 id="渲染进程向主进程发送消息"><a href="#渲染进程向主进程发送消息" class="headerlink" title="渲染进程向主进程发送消息"></a>渲染进程向主进程发送消息</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 渲染进程</span></span><br><span class="line"><span class="keyword">const</span> &#123; ipcRenderer &#125; = <span class="built_in">window</span>.require(<span class="string">&#x27;electron&#x27;</span>);</span><br><span class="line">ipcRenderer.send(<span class="string">&#x27;appMsg&#x27;</span>, <span class="string">&#x27;hi&#x27;</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">// 主进程</span></span><br><span class="line">ipcMain.on(<span class="string">&#x27;appMsg&#x27;</span>, <span class="function">(<span class="params">e, val</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;渲染进程通知主进程：&#x27;</span>+val)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h1 id="渲染进程获取主进程的变量值"><a href="#渲染进程获取主进程的变量值" class="headerlink" title="渲染进程获取主进程的变量值"></a>渲染进程获取主进程的变量值</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 主进程</span></span><br><span class="line"><span class="built_in">global</span>.test = &#123;</span><br><span class="line">  msg: <span class="string">&#x27;Hello&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 渲染进程</span></span><br><span class="line"><span class="keyword">const</span> &#123; remote &#125; = <span class="built_in">window</span>.require(<span class="string">&#x27;electron&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(remote.getGlobal(<span class="string">&#x27;test&#x27;</span>).msg);</span><br></pre></td></tr></table></figure>

<h1 id="主进程获取渲染进程变量"><a href="#主进程获取渲染进程变量" class="headerlink" title="主进程获取渲染进程变量"></a>主进程获取渲染进程变量</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 渲染进程获取变量值后通知主进程</span></span><br><span class="line"><span class="comment">// 渲染进程</span></span><br><span class="line"><span class="keyword">const</span> &#123; ipcRenderer &#125; = <span class="built_in">window</span>.require(<span class="string">&#x27;electron&#x27;</span>);</span><br><span class="line">ipcRenderer.send(<span class="string">&#x27;clientInitStatus&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 主进程</span></span><br><span class="line"><span class="keyword">let</span> initStatus = <span class="literal">false</span>;</span><br><span class="line">ipcMain.on(<span class="string">&#x27;clientInitStatus&#x27;</span>, <span class="function">(<span class="params">e, val</span>) =&gt;</span> &#123;</span><br><span class="line">  initStatus = val;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h1 id="渲染进程向主进程发送同步消息"><a href="#渲染进程向主进程发送同步消息" class="headerlink" title="渲染进程向主进程发送同步消息"></a>渲染进程向主进程发送同步消息</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 渲染进程</span></span><br><span class="line"><span class="keyword">let</span> a = ipcRenderer.sendSync(<span class="string">&#x27;syncMsg&#x27;</span>, <span class="string">&#x27;ping&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(a)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 主进程</span></span><br><span class="line">ipcMain.on(<span class="string">&#x27;syncMsg&#x27;</span>, <span class="function">(<span class="params">event, arg</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(arg) <span class="comment">// prints &quot;ping&quot;</span></span><br><span class="line">  event.returnValue = <span class="string">&#x27;pong&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>注意：ipcRenderer.sendSync如果放在vue的created或mounted中，会阻塞窗口渲染，同时返回值为uundefined，可以通过setTimeout(fn, 0)异常执行</p>
<h1 id="渲染进程向主进程发送异步消息"><a href="#渲染进程向主进程发送异步消息" class="headerlink" title="渲染进程向主进程发送异步消息"></a>渲染进程向主进程发送异步消息</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 渲染进程 </span></span><br><span class="line">ipcRenderer.send(<span class="string">&#x27;asyncMsg&#x27;</span>, <span class="string">&#x27;ping&#x27;</span>)</span><br><span class="line">ipcRenderer.on(<span class="string">&#x27;asyncReply&#x27;</span>, <span class="function">(<span class="params">event, arg</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(arg) <span class="comment">// prints &quot;pong&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 主进程</span></span><br><span class="line">ipcMain.on(<span class="string">&#x27;asyncMsg&#x27;</span>, <span class="function">(<span class="params">event, arg</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(arg) <span class="comment">// prints &quot;ping&quot;</span></span><br><span class="line">  event.reply(<span class="string">&#x27;asyncReply&#x27;</span>, <span class="string">&#x27;pong&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>注意：ipcRenderer.send如果放在vue的created或mounted中，不会执行，可通过setTimeout(fn, 0)异步执行</p>
<h1 id="渲染进程向主进程发送消息返回Promise"><a href="#渲染进程向主进程发送消息返回Promise" class="headerlink" title="渲染进程向主进程发送消息返回Promise"></a>渲染进程向主进程发送消息返回Promise</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 渲染进程</span></span><br><span class="line">ipcRenderer.invoke(<span class="string">&#x27;some-name&#x27;</span>, <span class="number">4</span>).then(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;last:&#x27;</span>, result)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 主进程</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomeWork</span>(<span class="params">opt</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;doSomeWork:&#x27;</span>, opt)</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">reslove,reject</span>)  =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&#x27;setTimeout&#x27;</span>)</span><br><span class="line">      reslove(<span class="number">10</span>)</span><br><span class="line">    &#125;, <span class="number">5000</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ipcMain.handle(<span class="string">&#x27;some-name&#x27;</span>, <span class="keyword">async</span> (event, someArgument) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;handle:&#x27;</span>,someArgument)</span><br><span class="line">  <span class="keyword">const</span> result = <span class="keyword">await</span> doSomeWork(someArgument)</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;result:&#x27;</span>, result)</span><br><span class="line">  <span class="keyword">return</span> result</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">打印顺序：</span></span><br><span class="line"><span class="comment">handle:4</span></span><br><span class="line"><span class="comment">doSomeWork: 4</span></span><br><span class="line"><span class="comment">setTimeout    // 5秒后执行</span></span><br><span class="line"><span class="comment">result: 10</span></span><br><span class="line"><span class="comment">last:10    // 渲染进程控制台，其它在命令符界面</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h1 id="ipcRenderer-postMessage"><a href="#ipcRenderer-postMessage" class="headerlink" title="ipcRenderer.postMessage"></a>ipcRenderer.postMessage</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 渲染进程</span></span><br><span class="line"><span class="keyword">const</span> &#123; port1, port2 &#125; = <span class="keyword">new</span> MessageChannel()</span><br><span class="line">ipcRenderer.postMessage(<span class="string">&#x27;port&#x27;</span>, &#123; <span class="attr">message</span>: <span class="string">&#x27;hello&#x27;</span> &#125;, [port1])</span><br><span class="line"></span><br><span class="line"><span class="comment">// 主进程</span></span><br><span class="line">ipcMain.on(<span class="string">&#x27;port&#x27;</span>, <span class="function">(<span class="params">e, msg</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [port] = e.ports</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>参考资料<br><a target="_blank" rel="noopener" href="https://www.electronjs.org/docs/api/ipc-renderer#ipcrendereronchannel-listener">https://www.electronjs.org/docs/api/ipc-renderer#ipcrendereronchannel-listener</a><br><a target="_blank" rel="noopener" href="https://www.electronjs.org/docs/api/ipc-main">https://www.electronjs.org/docs/api/ipc-main</a></p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2021/03/22/Electron%E4%B9%8B%E7%AA%97%E5%8F%A3%E6%9C%80%E5%B0%8F%E5%8C%96%E5%AF%B9%E5%AE%9A%E6%97%B6%E5%99%A8%E6%89%A7%E8%A1%8C%E7%9A%84%E5%BD%B1%E5%93%8D/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/22/Electron%E4%B9%8B%E7%AA%97%E5%8F%A3%E6%9C%80%E5%B0%8F%E5%8C%96%E5%AF%B9%E5%AE%9A%E6%97%B6%E5%99%A8%E6%89%A7%E8%A1%8C%E7%9A%84%E5%BD%B1%E5%93%8D/" class="post-title-link" itemprop="url">Electron之窗口最小化对定时器执行的影响</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-03-22 19:37:47 / 修改时间：19:39:39" itemprop="dateCreated datePublished" datetime="2021-03-22T19:37:47+08:00">2021-03-22</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Electron/" itemprop="url" rel="index"><span itemprop="name">Electron</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>测试环境：Electron 9.3.5</p>
<h1 id="setTimeout"><a href="#setTimeout" class="headerlink" title="setTimeout"></a>setTimeout</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">  <span class="built_in">console</span>.log(date.getTime())</span><br><span class="line">  <span class="built_in">setTimeout</span>(a, <span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line">a()</span><br></pre></td></tr></table></figure>
<p>测试结果：当窗口最小化或隐藏时，setTimeout会延迟执行，实测最小化时约2秒执行一次</p>
<h1 id="setInterval"><a href="#setInterval" class="headerlink" title="setInterval"></a>setInterval</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">  <span class="built_in">console</span>.log(date.getTime())</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">setInterval</span>(b, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure>
<p>测试结果：当窗口最小化或隐藏时，还是间隔一秒执行一次，最小化对setInterval没影响</p>
<h1 id="规避定时器异常方案"><a href="#规避定时器异常方案" class="headerlink" title="规避定时器异常方案"></a>规避定时器异常方案</h1><p>可以监听相应的事件根据窗口状态重置定时器</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">win.on(<span class="string">&#x27;restore&#x27;</span>, <span class="function">() =&gt;</span> &#123; ... &#125;)      <span class="comment">// 窗口从最小化恢复时触发</span></span><br><span class="line">win.on(<span class="string">&#x27;minimize&#x27;</span>, <span class="function">() =&gt;</span> &#123; ... &#125;)   <span class="comment">// 窗口最小化时触发</span></span><br><span class="line">win.minimizable()     <span class="comment">// 布尔值，返回窗口是否最小化状态</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2021/03/20/Electron%E4%B9%8B%E7%BD%91%E9%A1%B5%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/20/Electron%E4%B9%8B%E7%BD%91%E9%A1%B5%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86/" class="post-title-link" itemprop="url">Electron之网页数据请求处理</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-03-20 22:27:14 / 修改时间：22:33:25" itemprop="dateCreated datePublished" datetime="2021-03-20T22:27:14+08:00">2021-03-20</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Electron/" itemprop="url" rel="index"><span itemprop="name">Electron</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在项目中使用传统的ajax、axios等进行数据请求均会存在跨域问题，Electron的net模块使用Chromium的原生网络库发出HTTP / HTTPS请求，提供更好的网络代理支持（解决跨域问题），还可以通过该模块检查网络状态。</p>
<blockquote>
<p>request方：方法，请求数据接口，返回请求数据相关信息<br>isOnline：方法，判断网络是否正常主法，返回布尔值<br>online： 属性，返回布尔值，表示网络状态是否正常</p>
</blockquote>
<h1 id="模块封装"><a href="#模块封装" class="headerlink" title="模块封装"></a>模块封装</h1><p>对于网络请求部分基础功能进行了如下封装：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;net&#125; = <span class="built_in">window</span>.require(<span class="string">&#x27;electron&#x27;</span>).remote;</span><br><span class="line"><span class="keyword">const</span> Querystring = <span class="built_in">require</span>(<span class="string">&#x27;querystring&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> Url = <span class="built_in">require</span>(<span class="string">&#x27;url&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> Log = <span class="built_in">require</span>(<span class="string">&#x27;./Log&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> Efetch = &#123;</span><br><span class="line">  <span class="function"><span class="title">net</span>(<span class="params">opts, params, resolve, reject</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> request = net.request(opts);</span><br><span class="line">    request.on(<span class="string">&#x27;response&#x27;</span>, <span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">      response.on(<span class="string">&quot;data&quot;</span>, <span class="function">(<span class="params">data</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> result = IsJson(<span class="string">`<span class="subst">$&#123;data&#125;</span>`</span>) ? <span class="built_in">JSON</span>.parse(<span class="string">`<span class="subst">$&#123;data&#125;</span>`</span>) : <span class="string">`<span class="subst">$&#123;data&#125;</span>`</span>;   <span class="comment">// data.toString();</span></span><br><span class="line">        <span class="keyword">if</span>(response.statusCode == <span class="number">200</span>)&#123;</span><br><span class="line">          resolve(result);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          Log(<span class="string">&#x27;net status:&#x27;</span> + response.statusCode);</span><br><span class="line">          reject(result);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">      response.on(<span class="string">&#x27;end&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        Log(<span class="string">&#x27;No more data in response.&#x27;</span>);</span><br><span class="line">      &#125;)      </span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    request.write(Querystring.stringify(params));</span><br><span class="line">    request.end();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">get</span>(<span class="params">url, params=&#123;&#125;, header=&#123;&#125;</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> options = &#123;</span><br><span class="line">      method: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">      url: url,</span><br><span class="line">      params: params,</span><br><span class="line">      header: header</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.request(options);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">post</span>(<span class="params">url, params=&#123;&#125;, header=&#123;&#125;</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> options = &#123;</span><br><span class="line">      method: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">      url: url,</span><br><span class="line">      params: params,</span><br><span class="line">      header: header</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.request(options);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">request</span>(<span class="params">options</span>)</span> &#123;  <span class="comment">// method, url, params, header</span></span><br><span class="line">    Log(<span class="string">&#x27;request:&#x27;</span> + options.url);</span><br><span class="line">    Log(options.params);</span><br><span class="line">    <span class="keyword">let</span> opt = <span class="built_in">this</span>.formatParams(options);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.net(opt, options.params, resolve, reject)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,  </span><br><span class="line">  <span class="function"><span class="title">formatParams</span>(<span class="params">options</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> header = &#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded;charset=UTF-8&#x27;</span>&#125;;</span><br><span class="line">    <span class="keyword">let</span> method = options.method || <span class="string">&#x27;GET&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(options.header)&#123;</span><br><span class="line">      <span class="built_in">Object</span>.assign(header, options.header)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> myUrl = Url.parse(options.url);</span><br><span class="line">    <span class="keyword">let</span> port = <span class="number">80</span>;</span><br><span class="line">    <span class="keyword">if</span>(!myUrl.port) &#123;</span><br><span class="line">      port = myUrl.protocol == <span class="string">&#x27;https:&#x27;</span> ? <span class="number">443</span> : port;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      port = myUrl.port;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> path = method == <span class="string">&#x27;POST&#x27;</span> ? myUrl.pathname : myUrl.pathname + myUrl.search;</span><br><span class="line">    <span class="keyword">let</span> opt = &#123;</span><br><span class="line">      method: method,</span><br><span class="line">      protocol: myUrl.protocol,</span><br><span class="line">      hostname: myUrl.host,</span><br><span class="line">      port: port,</span><br><span class="line">      path: path,</span><br><span class="line">      headers: header</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> opt</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">isJson</span>(<span class="params">opt</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">      <span class="built_in">JSON</span>.parse(opt);</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = Efetch</span><br></pre></td></tr></table></figure>

<h1 id="接口调用统一封装"><a href="#接口调用统一封装" class="headerlink" title="接口调用统一封装"></a>接口调用统一封装</h1><p>实现统一设置header,统一处理请求参数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Efetch = <span class="built_in">require</span>(<span class="string">&#x27;./Efetch&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> Ajax = &#123;</span><br><span class="line">  post: <span class="function">(<span class="params">url, params</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> header = &#123;</span><br><span class="line">      sign: <span class="string">&#x27;test&#x27;</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    params.token = <span class="string">&#x27;123&#x27;</span>;</span><br><span class="line">    <span class="keyword">let</span> baseUrl = url.indexOf(<span class="string">&#x27;http://&#x27;</span>) == <span class="number">0</span> || url.indexOf(<span class="string">&#x27;https://&#x27;</span>) == <span class="number">0</span> ? <span class="string">&#x27;&#x27;</span> : <span class="string">&#x27;https://api.test.com&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      NetFetch.post(baseUrl+url, params, header)</span><br><span class="line">        .then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">          resolve(data)</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">          reject(e)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = Ajax</span><br></pre></td></tr></table></figure>

<h1 id="使用示例"><a href="#使用示例" class="headerlink" title="使用示例"></a>使用示例</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Ajax.post(<span class="string">&#x27;/getInfo&#x27;</span>, &#123;<span class="attr">id</span>:<span class="number">1</span>&#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    </span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>参考资料：<br><a target="_blank" rel="noopener" href="https://www.electronjs.org/docs/api/net">https://www.electronjs.org/docs/api/net</a></p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2021/03/07/webpack%E9%85%8D%E7%BD%AErequire%E5%BC%95%E5%85%A5%E6%96%87%E4%BB%B6%E4%B8%8D%E6%89%93%E5%8C%85/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/07/webpack%E9%85%8D%E7%BD%AErequire%E5%BC%95%E5%85%A5%E6%96%87%E4%BB%B6%E4%B8%8D%E6%89%93%E5%8C%85/" class="post-title-link" itemprop="url">webpack配置require引入文件不打包</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-03-07 22:13:54 / 修改时间：22:23:25" itemprop="dateCreated datePublished" datetime="2021-03-07T22:13:54+08:00">2021-03-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Webpack/" itemprop="url" rel="index"><span itemprop="name">Webpack</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>使用webpack打包的项目在开发过程中，出于需要可能要处理某个通过require引入的模块不被webpack打包处理，具体有以下几种。</p>
<h1 id="一、通过-hack-让-webpack-无法识别这个-require"><a href="#一、通过-hack-让-webpack-无法识别这个-require" class="headerlink" title="一、通过 hack 让 webpack 无法识别这个 require"></a>一、通过 hack 让 webpack 无法识别这个 require</h1><p><strong>方法一：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="string">&#x27;require&#x27;</span>)(<span class="built_in">module</span>)</span><br></pre></td></tr></table></figure>
<p><strong>方法二：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> func = <span class="keyword">new</span> <span class="built_in">Function</span>(<span class="string">&#x27;module&#x27;</span>, <span class="string">&#x27;return require(module)&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; MyModule &#125; = func(<span class="string">&#x27;../build/Release/myModule.node&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="二、通过webpack的externals配置不打包指定模块"><a href="#二、通过webpack的externals配置不打包指定模块" class="headerlink" title="二、通过webpack的externals配置不打包指定模块"></a>二、通过webpack的externals配置不打包指定模块</h1><p>在webpack的externals:配置如下代码示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">externals: &#123;</span><br><span class="line">  MyModule: &#39;commonjs2 .&#x2F;build&#x2F;my.node&#39;       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">externals: &#123;</span><br><span class="line">  MyModule: &#96;require(&#39;.&#x2F;build&#x2F;my.node&#39;)&#96;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>页面引入方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const &#123; MyModule&#125; &#x3D; require(&#39;MyModule&#39;);</span><br></pre></td></tr></table></figure>

<h1 id="三、-non-webpack-require-方法实现"><a href="#三、-non-webpack-require-方法实现" class="headerlink" title="三、__non_webpack_require__方法实现"></a>三、__non_webpack_require__方法实现</h1><p><strong>non_webpack_require</strong> (webpack 特有变量)<br>官文文档解释：生成一个不会被 webpack 解析的 require 函数。配合全局可以获取到的 require 函数，可以完成一些酷炫操作。<br><strong>使用方法</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const MyModule&#x3D; __non_webpack_require__(&#39;.&#x2F;build&#x2F;my.node&#39;);</span><br></pre></td></tr></table></figure>
<p>注意：如果项目开启了esList,会导致在命令行工具提示报错“__non_webpack_require__”is not defined，实际运行正常</p>
<hr>
<p><strong>其他知识点</strong><br>webpack可通过IgnorePlugin配置忽略匹配目录或文件的引入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">  new Webpack.IgnorePlugin(&#x2F;\..\&#x2F;build&#x2F;)  &#x2F;&#x2F; 忽略build目录下的引用，代码会提示引用的文件不存在</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>忽略node原生模块打包<br><a target="_blank" rel="noopener" href="https://webpack.js.org/configuration/node/#node">https://webpack.js.org/configuration/node/#node</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">config &#x3D; &#123;</span><br><span class="line">  node: &#123;</span><br><span class="line">    global: false,</span><br><span class="line">    __filename: false,</span><br><span class="line">    __dirname: false,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>参考资料<br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/52990313">https://zhuanlan.zhihu.com/p/52990313</a><br><a target="_blank" rel="noopener" href="https://webpack.docschina.org/api/module-variables/#__non_webpack_require__-webpack-">https://webpack.docschina.org/api/module-variables/#__non_webpack_require__-webpack-</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/wang1006008051/article/details/111677113">https://blog.csdn.net/wang1006008051/article/details/111677113</a></p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2021/03/01/Electron%E4%B9%8B%E5%BC%82%E5%BD%A2%E7%AA%97%E5%8F%A3%E9%80%8F%E6%98%8E%E5%8C%BA%E5%9F%9F%E7%A9%BF%E9%80%8F%E7%82%B9%E5%87%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/01/Electron%E4%B9%8B%E5%BC%82%E5%BD%A2%E7%AA%97%E5%8F%A3%E9%80%8F%E6%98%8E%E5%8C%BA%E5%9F%9F%E7%A9%BF%E9%80%8F%E7%82%B9%E5%87%BB/" class="post-title-link" itemprop="url">Electron之异形窗口透明区域穿透点击</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-03-01 19:15:52 / 修改时间：19:47:17" itemprop="dateCreated datePublished" datetime="2021-03-01T19:15:52+08:00">2021-03-01</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Electron/" itemprop="url" rel="index"><span itemprop="name">Electron</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h1><p>Electron可通过设置窗口背景透明，实现异形窗口，此时窗口透明区域不可穿透点击，需结合Electron的win.setIgnoreMouseEvents(true)来控制是否可点击穿透。</p>
<p>网页监听鼠标的mouseenter和mouseleave，当鼠标移进透明区域时设置可穿透点击，移出透明区域设置不可穿透点击。<br>透明区域可通过SVG的path绘制，在path上监听mouseenter、mouseleave事件</p>
<h1 id="实现示例"><a href="#实现示例" class="headerlink" title="实现示例"></a>实现示例</h1><p><img src="/img/2021-3/electron-shape.png"></p>
<p><strong>Electron main.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; app, BrowserWindow, ipcMain, nativeTheme &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createWindow</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> win = <span class="keyword">new</span> BrowserWindow(&#123;</span><br><span class="line">    width: <span class="number">636</span>,</span><br><span class="line">    height: <span class="number">608</span>,</span><br><span class="line">    transparent: <span class="literal">true</span>, </span><br><span class="line">    frame: <span class="literal">false</span>,</span><br><span class="line">    webPreferences: &#123;</span><br><span class="line">      enableRemoteModule: <span class="literal">true</span>,</span><br><span class="line">      nodeIntegration: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  win.loadFile(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.whenReady().then(createWindow)</span><br></pre></td></tr></table></figure>

<p><strong>网页html代码</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">id</span>=<span class="string">&quot;mysvg&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 638 608&quot;</span> <span class="attr">preserveAspectRatio</span>=<span class="string">&quot;xMidYMid meet&quot;</span> <span class="attr">width</span>=<span class="string">&quot;638&quot;</span> <span class="attr">height</span>=<span class="string">&quot;608&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">path</span> <span class="attr">id</span>=<span class="string">&quot;myPath&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;transparent&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">d</span>=<span class="string">&quot;M-0.000,0.000 C141.651,0.335 283.344,0.670 424.995,1.005 C387.422,8.830 348.302,70.646 323.519,73.360 C281.998,58.785 272.863,43.524 244.146,81.400 C246.649,89.071 251.449,102.745 247.160,109.538 C240.093,117.208 223.391,114.533 211.995,118.582 C204.293,122.937 196.589,127.292 188.887,131.646 C188.552,134.996 188.217,138.346 187.882,141.696 C180.603,143.984 176.794,148.338 171.807,152.750 C162.095,152.750 152.381,152.750 142.670,152.750 C144.814,138.677 141.003,133.625 137.646,121.597 C137.311,121.597 136.976,121.597 136.642,121.597 C135.302,124.277 133.962,126.957 132.623,129.637 C136.113,135.403 140.492,139.559 141.665,147.725 C140.995,149.400 140.325,151.075 139.656,152.750 C122.300,152.383 54.545,149.388 49.231,157.775 C45.436,163.783 46.967,179.518 47.222,188.928 C40.524,187.923 33.825,186.918 27.127,185.913 C27.127,186.248 27.127,186.583 27.127,186.918 C33.825,190.267 40.524,193.618 47.222,196.967 C47.222,201.656 47.222,206.347 47.222,211.036 C28.469,213.932 4.684,226.921 1.005,245.204 C0.670,245.204 0.335,245.204 -0.000,245.204 C-0.000,163.477 -0.000,81.726 -0.000,0.000 ZM639.000,0.000 C639.000,203.646 639.000,407.354 639.000,611.000 C549.589,610.665 460.151,610.330 370.741,609.995 C393.227,606.021 396.204,579.094 389.830,553.719 C382.268,523.616 368.018,490.884 359.689,452.220 C360.024,452.220 360.359,452.220 360.693,452.220 C361.028,452.890 361.363,453.560 361.698,454.230 C372.414,474.662 383.133,495.100 393.849,515.531 C409.993,504.290 431.090,455.364 431.024,428.102 C451.818,428.419 555.314,431.385 560.632,423.077 C567.045,412.449 562.800,310.223 562.642,288.416 C567.283,286.323 570.440,285.022 572.689,280.377 C569.340,281.381 565.990,282.387 562.642,283.391 C562.976,253.581 563.311,223.762 563.646,193.952 C596.625,185.529 585.166,140.347 631.967,136.671 C631.967,138.011 631.967,139.351 631.967,140.691 C625.604,144.710 619.240,148.731 612.877,152.750 C612.877,153.085 612.877,153.420 612.877,153.755 C626.038,152.429 630.970,144.945 637.995,137.676 C637.995,136.336 637.995,134.996 637.995,133.656 C615.110,119.997 577.533,164.674 562.642,173.854 C563.944,126.466 515.064,151.640 483.269,152.750 C478.206,131.689 462.742,144.997 451.118,135.666 C449.113,134.057 451.312,130.803 448.104,129.637 C440.737,130.306 433.367,130.976 426.000,131.646 C426.000,131.311 426.000,130.976 426.000,130.641 C466.935,120.257 510.306,64.132 480.255,16.079 C462.982,12.070 439.252,9.659 427.005,0.000 C497.663,0.000 568.342,0.000 639.000,0.000 ZM442.075,23.113 C443.080,23.113 444.085,23.113 445.090,23.113 C480.852,49.723 458.378,94.262 429.014,109.538 C416.796,106.891 411.044,104.027 400.882,95.469 C400.882,95.134 400.882,94.799 400.882,94.464 C401.552,94.129 402.222,93.794 402.892,93.459 C412.214,93.073 418.668,90.918 421.981,96.474 C427.832,94.595 440.336,83.306 439.061,74.365 C436.382,74.030 433.703,73.695 431.024,73.360 C431.024,72.355 431.024,71.350 431.024,70.345 C437.386,65.321 443.751,60.296 450.113,55.271 C450.312,49.069 450.018,47.012 447.099,44.217 C449.075,49.030 449.293,52.797 447.099,57.281 C427.892,60.692 425.989,89.946 406.910,73.360 C401.266,73.931 395.059,77.891 389.830,78.385 C385.377,78.806 377.746,74.641 366.722,76.375 C367.057,73.695 367.392,71.015 367.726,68.336 C366.387,68.336 365.047,68.336 363.708,68.336 C364.712,66.996 365.717,65.656 366.722,64.316 C377.103,57.282 387.487,50.246 397.868,43.212 C412.602,36.513 427.341,29.812 442.075,23.113 ZM285.340,428.102 C285.663,452.521 296.152,451.966 303.425,466.289 C303.759,466.289 304.094,466.289 304.429,466.289 C304.764,462.940 305.099,459.590 305.434,456.240 C306.773,457.245 308.113,458.250 309.453,459.255 C315.869,478.435 333.637,489.613 343.613,505.482 C351.065,517.334 355.270,538.648 360.693,550.704 C370.551,572.618 353.489,590.289 368.731,611.000 C245.833,611.000 122.898,611.000 -0.000,611.000 C0.335,489.415 0.670,367.794 1.005,246.209 C1.005,246.879 1.005,247.549 1.005,248.219 C3.684,252.573 6.363,256.929 9.042,261.283 C18.563,273.926 42.008,282.697 47.222,298.465 C47.222,318.227 47.222,337.995 47.222,357.757 C29.880,361.735 24.000,377.758 18.085,392.929 C18.755,393.264 19.425,393.599 20.094,393.934 C29.523,387.712 38.223,379.547 47.222,373.836 C46.736,388.115 43.226,420.503 52.245,426.092 C60.037,430.951 81.861,428.350 93.439,428.102 C85.282,442.703 73.066,454.118 67.316,471.314 C89.164,460.650 112.868,446.378 134.632,437.146 C134.632,437.481 134.632,437.816 134.632,438.151 C130.740,450.999 133.725,465.940 139.656,476.339 C152.661,475.886 156.306,469.979 167.788,468.299 C184.647,465.833 194.389,476.020 207.976,477.344 C222.095,468.460 232.217,463.218 236.108,444.181 C236.443,438.822 236.778,433.461 237.113,428.102 C237.113,428.772 237.113,429.442 237.113,430.112 C239.792,434.801 242.472,439.492 245.151,444.181 C246.156,443.176 247.160,442.171 248.165,441.166 C253.713,438.700 257.207,434.100 259.217,428.102 C267.924,428.102 276.633,428.102 285.340,428.102 Z&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>网页CSS代码</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span>,<span class="selector-tag">body</span>&#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">body</span>&#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">win.png</span>) no-repeat <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>网页js代码</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> win = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>).remote.getCurrentWindow()</span><br><span class="line"><span class="keyword">const</span> el = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myPath&#x27;</span>)</span><br><span class="line">el.addEventListener(<span class="string">&#x27;mouseenter&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  win.setIgnoreMouseEvents(<span class="literal">true</span>, &#123; <span class="attr">forward</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">el.addEventListener(<span class="string">&#x27;mouseleave&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  win.setIgnoreMouseEvents(<span class="literal">false</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>


<h1 id="photoshop生成SVG-path代码"><a href="#photoshop生成SVG-path代码" class="headerlink" title="photoshop生成SVG path代码"></a>photoshop生成SVG path代码</h1><p>photoshop可以把形状直接复制出SVG代码，实现形状图层有以下两种方法：<br><strong>方法一：</strong>选择钢笔工具，类型选择形状，新建一个图层绘制对应的形状，在该图层上点击右键“复制SVG”<br><strong>方法二：</strong>选区选中透明区域，把选区转为路径，在画布上右键“定义自定形状”；工具栏选择“自定形状工具”，类型选择形状，再选择对应的自制自定义图形，插入到图层中，图层右键“复制SVG”</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2021/02/27/Electron%E4%B9%8B%E8%BF%9C%E7%A8%8B%E9%A1%B5%E9%9D%A2%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/27/Electron%E4%B9%8B%E8%BF%9C%E7%A8%8B%E9%A1%B5%E9%9D%A2%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5/" class="post-title-link" itemprop="url">Electron之远程页面代码注入</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-02-27 16:51:45 / 修改时间：16:52:40" itemprop="dateCreated datePublished" datetime="2021-02-27T16:51:45+08:00">2021-02-27</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Electron/" itemprop="url" rel="index"><span itemprop="name">Electron</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)  </span><br><span class="line"><span class="keyword">const</span> win = <span class="keyword">new</span> BrowserWindow()</span><br><span class="line">win.loadURL(<span class="string">&#x27;http://www.baidu.com&#x27;</span>)</span><br><span class="line">win.webContents.on(<span class="string">&quot;did-finish-load&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 直接注入CSS代码</span></span><br><span class="line">  win.webContents.insertCSS(<span class="string">&quot;body&#123;border:10px solid red !important;&#125;&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 注入CSS文件</span></span><br><span class="line">  <span class="keyword">const</span> css = fs.readFileSync(path.join(__dirname, <span class="string">&#x27;./insertCss.css&#x27;</span>)).toString();</span><br><span class="line">  win.webContents.insertCSS(css);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 直接注入JS代码</span></span><br><span class="line">  win.webContents.executeJavaScript(<span class="string">&#x27;alert(&quot;test&quot;);&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 注入JS文件</span></span><br><span class="line">  <span class="keyword">const</span> js = fs.readFileSync(path.join(__dirname, <span class="string">&#x27;./insertJs.js&#x27;</span>)).toString();</span><br><span class="line">  win.webContents.executeJavaScript(js);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 在渲染进程焦点位置输入内容，如文本框</span></span><br><span class="line">  win.webContents.insertText(<span class="string">&quot;test&quot;</span>)</span><br><span class="line">  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">niniun1024</p>
  <div class="site-description" itemprop="description">niniun1024's blog</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">26</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">niniun1024</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
