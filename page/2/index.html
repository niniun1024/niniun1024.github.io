<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"niniun1024.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="niniun1024&#39;s blog">
<meta property="og:type" content="website">
<meta property="og:title" content="niniun1024&#39;s blog">
<meta property="og:url" content="http://niniun1024.github.io/page/2/index.html">
<meta property="og:site_name" content="niniun1024&#39;s blog">
<meta property="og:description" content="niniun1024&#39;s blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="niniun1024">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://niniun1024.github.io/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>niniun1024's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">niniun1024's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2021/03/20/Electron%E4%B9%8B%E7%BD%91%E9%A1%B5%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/20/Electron%E4%B9%8B%E7%BD%91%E9%A1%B5%E6%95%B0%E6%8D%AE%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86/" class="post-title-link" itemprop="url">Electron之网页数据请求处理</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-03-20 22:27:14 / 修改时间：22:33:25" itemprop="dateCreated datePublished" datetime="2021-03-20T22:27:14+08:00">2021-03-20</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Electron/" itemprop="url" rel="index"><span itemprop="name">Electron</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在项目中使用传统的ajax、axios等进行数据请求均会存在跨域问题，Electron的net模块使用Chromium的原生网络库发出HTTP / HTTPS请求，提供更好的网络代理支持（解决跨域问题），还可以通过该模块检查网络状态。</p>
<blockquote>
<p>request方：方法，请求数据接口，返回请求数据相关信息<br>isOnline：方法，判断网络是否正常主法，返回布尔值<br>online： 属性，返回布尔值，表示网络状态是否正常</p>
</blockquote>
<h1 id="模块封装"><a href="#模块封装" class="headerlink" title="模块封装"></a>模块封装</h1><p>对于网络请求部分基础功能进行了如下封装：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;net&#125; = <span class="built_in">window</span>.require(<span class="string">&#x27;electron&#x27;</span>).remote;</span><br><span class="line"><span class="keyword">const</span> Querystring = <span class="built_in">require</span>(<span class="string">&#x27;querystring&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> Url = <span class="built_in">require</span>(<span class="string">&#x27;url&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> Log = <span class="built_in">require</span>(<span class="string">&#x27;./Log&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> Efetch = &#123;</span><br><span class="line">  <span class="function"><span class="title">net</span>(<span class="params">opts, params, resolve, reject</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> request = net.request(opts);</span><br><span class="line">    request.on(<span class="string">&#x27;response&#x27;</span>, <span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">      response.on(<span class="string">&quot;data&quot;</span>, <span class="function">(<span class="params">data</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> result = IsJson(<span class="string">`<span class="subst">$&#123;data&#125;</span>`</span>) ? <span class="built_in">JSON</span>.parse(<span class="string">`<span class="subst">$&#123;data&#125;</span>`</span>) : <span class="string">`<span class="subst">$&#123;data&#125;</span>`</span>;   <span class="comment">// data.toString();</span></span><br><span class="line">        <span class="keyword">if</span>(response.statusCode == <span class="number">200</span>)&#123;</span><br><span class="line">          resolve(result);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          Log(<span class="string">&#x27;net status:&#x27;</span> + response.statusCode);</span><br><span class="line">          reject(result);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">      response.on(<span class="string">&#x27;end&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        Log(<span class="string">&#x27;No more data in response.&#x27;</span>);</span><br><span class="line">      &#125;)      </span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    request.write(Querystring.stringify(params));</span><br><span class="line">    request.end();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">get</span>(<span class="params">url, params=&#123;&#125;, header=&#123;&#125;</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> options = &#123;</span><br><span class="line">      method: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">      url: url,</span><br><span class="line">      params: params,</span><br><span class="line">      header: header</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.request(options);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">post</span>(<span class="params">url, params=&#123;&#125;, header=&#123;&#125;</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> options = &#123;</span><br><span class="line">      method: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">      url: url,</span><br><span class="line">      params: params,</span><br><span class="line">      header: header</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.request(options);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">request</span>(<span class="params">options</span>)</span> &#123;  <span class="comment">// method, url, params, header</span></span><br><span class="line">    Log(<span class="string">&#x27;request:&#x27;</span> + options.url);</span><br><span class="line">    Log(options.params);</span><br><span class="line">    <span class="keyword">let</span> opt = <span class="built_in">this</span>.formatParams(options);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.net(opt, options.params, resolve, reject)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,  </span><br><span class="line">  <span class="function"><span class="title">formatParams</span>(<span class="params">options</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> header = &#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded;charset=UTF-8&#x27;</span>&#125;;</span><br><span class="line">    <span class="keyword">let</span> method = options.method || <span class="string">&#x27;GET&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(options.header)&#123;</span><br><span class="line">      <span class="built_in">Object</span>.assign(header, options.header)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> myUrl = Url.parse(options.url);</span><br><span class="line">    <span class="keyword">let</span> port = <span class="number">80</span>;</span><br><span class="line">    <span class="keyword">if</span>(!myUrl.port) &#123;</span><br><span class="line">      port = myUrl.protocol == <span class="string">&#x27;https:&#x27;</span> ? <span class="number">443</span> : port;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      port = myUrl.port;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> path = method == <span class="string">&#x27;POST&#x27;</span> ? myUrl.pathname : myUrl.pathname + myUrl.search;</span><br><span class="line">    <span class="keyword">let</span> opt = &#123;</span><br><span class="line">      method: method,</span><br><span class="line">      protocol: myUrl.protocol,</span><br><span class="line">      hostname: myUrl.host,</span><br><span class="line">      port: port,</span><br><span class="line">      path: path,</span><br><span class="line">      headers: header</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> opt</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">isJson</span>(<span class="params">opt</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">      <span class="built_in">JSON</span>.parse(opt);</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = Efetch</span><br></pre></td></tr></table></figure>

<h1 id="接口调用统一封装"><a href="#接口调用统一封装" class="headerlink" title="接口调用统一封装"></a>接口调用统一封装</h1><p>实现统一设置header,统一处理请求参数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Efetch = <span class="built_in">require</span>(<span class="string">&#x27;./Efetch&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> Ajax = &#123;</span><br><span class="line">  post: <span class="function">(<span class="params">url, params</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> header = &#123;</span><br><span class="line">      sign: <span class="string">&#x27;test&#x27;</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    params.token = <span class="string">&#x27;123&#x27;</span>;</span><br><span class="line">    <span class="keyword">let</span> baseUrl = url.indexOf(<span class="string">&#x27;http://&#x27;</span>) == <span class="number">0</span> || url.indexOf(<span class="string">&#x27;https://&#x27;</span>) == <span class="number">0</span> ? <span class="string">&#x27;&#x27;</span> : <span class="string">&#x27;https://api.test.com&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">      NetFetch.post(baseUrl+url, params, header)</span><br><span class="line">        .then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">          resolve(data)</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">          reject(e)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = Ajax</span><br></pre></td></tr></table></figure>

<h1 id="使用示例"><a href="#使用示例" class="headerlink" title="使用示例"></a>使用示例</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Ajax.post(<span class="string">&#x27;/getInfo&#x27;</span>, &#123;<span class="attr">id</span>:<span class="number">1</span>&#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    </span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>参考资料：<br><a target="_blank" rel="noopener" href="https://www.electronjs.org/docs/api/net">https://www.electronjs.org/docs/api/net</a></p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2021/03/07/webpack%E9%85%8D%E7%BD%AErequire%E5%BC%95%E5%85%A5%E6%96%87%E4%BB%B6%E4%B8%8D%E6%89%93%E5%8C%85/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/07/webpack%E9%85%8D%E7%BD%AErequire%E5%BC%95%E5%85%A5%E6%96%87%E4%BB%B6%E4%B8%8D%E6%89%93%E5%8C%85/" class="post-title-link" itemprop="url">webpack配置require引入文件不打包</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-03-07 22:13:54 / 修改时间：22:23:25" itemprop="dateCreated datePublished" datetime="2021-03-07T22:13:54+08:00">2021-03-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Webpack/" itemprop="url" rel="index"><span itemprop="name">Webpack</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>使用webpack打包的项目在开发过程中，出于需要可能要处理某个通过require引入的模块不被webpack打包处理，具体有以下几种。</p>
<h1 id="一、通过-hack-让-webpack-无法识别这个-require"><a href="#一、通过-hack-让-webpack-无法识别这个-require" class="headerlink" title="一、通过 hack 让 webpack 无法识别这个 require"></a>一、通过 hack 让 webpack 无法识别这个 require</h1><p><strong>方法一：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="string">&#x27;require&#x27;</span>)(<span class="built_in">module</span>)</span><br></pre></td></tr></table></figure>
<p><strong>方法二：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> func = <span class="keyword">new</span> <span class="built_in">Function</span>(<span class="string">&#x27;module&#x27;</span>, <span class="string">&#x27;return require(module)&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; MyModule &#125; = func(<span class="string">&#x27;../build/Release/myModule.node&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="二、通过webpack的externals配置不打包指定模块"><a href="#二、通过webpack的externals配置不打包指定模块" class="headerlink" title="二、通过webpack的externals配置不打包指定模块"></a>二、通过webpack的externals配置不打包指定模块</h1><p>在webpack的externals:配置如下代码示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">externals: &#123;</span><br><span class="line">  MyModule: &#39;commonjs2 .&#x2F;build&#x2F;my.node&#39;       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">externals: &#123;</span><br><span class="line">  MyModule: &#96;require(&#39;.&#x2F;build&#x2F;my.node&#39;)&#96;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>页面引入方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const &#123; MyModule&#125; &#x3D; require(&#39;MyModule&#39;);</span><br></pre></td></tr></table></figure>

<h1 id="三、-non-webpack-require-方法实现"><a href="#三、-non-webpack-require-方法实现" class="headerlink" title="三、__non_webpack_require__方法实现"></a>三、__non_webpack_require__方法实现</h1><p><strong>non_webpack_require</strong> (webpack 特有变量)<br>官文文档解释：生成一个不会被 webpack 解析的 require 函数。配合全局可以获取到的 require 函数，可以完成一些酷炫操作。<br><strong>使用方法</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const MyModule&#x3D; __non_webpack_require__(&#39;.&#x2F;build&#x2F;my.node&#39;);</span><br></pre></td></tr></table></figure>
<p>注意：如果项目开启了esList,会导致在命令行工具提示报错“__non_webpack_require__”is not defined，实际运行正常</p>
<hr>
<p><strong>其他知识点</strong><br>webpack可通过IgnorePlugin配置忽略匹配目录或文件的引入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">  new Webpack.IgnorePlugin(&#x2F;\..\&#x2F;build&#x2F;)  &#x2F;&#x2F; 忽略build目录下的引用，代码会提示引用的文件不存在</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>忽略node原生模块打包<br><a target="_blank" rel="noopener" href="https://webpack.js.org/configuration/node/#node">https://webpack.js.org/configuration/node/#node</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">config &#x3D; &#123;</span><br><span class="line">  node: &#123;</span><br><span class="line">    global: false,</span><br><span class="line">    __filename: false,</span><br><span class="line">    __dirname: false,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>参考资料<br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/52990313">https://zhuanlan.zhihu.com/p/52990313</a><br><a target="_blank" rel="noopener" href="https://webpack.docschina.org/api/module-variables/#__non_webpack_require__-webpack-">https://webpack.docschina.org/api/module-variables/#__non_webpack_require__-webpack-</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/wang1006008051/article/details/111677113">https://blog.csdn.net/wang1006008051/article/details/111677113</a></p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2021/03/01/Electron%E4%B9%8B%E5%BC%82%E5%BD%A2%E7%AA%97%E5%8F%A3%E9%80%8F%E6%98%8E%E5%8C%BA%E5%9F%9F%E7%A9%BF%E9%80%8F%E7%82%B9%E5%87%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/01/Electron%E4%B9%8B%E5%BC%82%E5%BD%A2%E7%AA%97%E5%8F%A3%E9%80%8F%E6%98%8E%E5%8C%BA%E5%9F%9F%E7%A9%BF%E9%80%8F%E7%82%B9%E5%87%BB/" class="post-title-link" itemprop="url">Electron之异形窗口透明区域穿透点击</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-03-01 19:15:52 / 修改时间：19:47:17" itemprop="dateCreated datePublished" datetime="2021-03-01T19:15:52+08:00">2021-03-01</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Electron/" itemprop="url" rel="index"><span itemprop="name">Electron</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h1><p>Electron可通过设置窗口背景透明，实现异形窗口，此时窗口透明区域不可穿透点击，需结合Electron的win.setIgnoreMouseEvents(true)来控制是否可点击穿透。</p>
<p>网页监听鼠标的mouseenter和mouseleave，当鼠标移进透明区域时设置可穿透点击，移出透明区域设置不可穿透点击。<br>透明区域可通过SVG的path绘制，在path上监听mouseenter、mouseleave事件</p>
<h1 id="实现示例"><a href="#实现示例" class="headerlink" title="实现示例"></a>实现示例</h1><p><img src="/img/2021-3/electron-shape.png"></p>
<p><strong>Electron main.js</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; app, BrowserWindow, ipcMain, nativeTheme &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createWindow</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> win = <span class="keyword">new</span> BrowserWindow(&#123;</span><br><span class="line">    width: <span class="number">636</span>,</span><br><span class="line">    height: <span class="number">608</span>,</span><br><span class="line">    transparent: <span class="literal">true</span>, </span><br><span class="line">    frame: <span class="literal">false</span>,</span><br><span class="line">    webPreferences: &#123;</span><br><span class="line">      enableRemoteModule: <span class="literal">true</span>,</span><br><span class="line">      nodeIntegration: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  win.loadFile(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.whenReady().then(createWindow)</span><br></pre></td></tr></table></figure>

<p><strong>网页html代码</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">id</span>=<span class="string">&quot;mysvg&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 638 608&quot;</span> <span class="attr">preserveAspectRatio</span>=<span class="string">&quot;xMidYMid meet&quot;</span> <span class="attr">width</span>=<span class="string">&quot;638&quot;</span> <span class="attr">height</span>=<span class="string">&quot;608&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">path</span> <span class="attr">id</span>=<span class="string">&quot;myPath&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;transparent&quot;</span></span></span><br><span class="line"><span class="tag"> <span class="attr">d</span>=<span class="string">&quot;M-0.000,0.000 C141.651,0.335 283.344,0.670 424.995,1.005 C387.422,8.830 348.302,70.646 323.519,73.360 C281.998,58.785 272.863,43.524 244.146,81.400 C246.649,89.071 251.449,102.745 247.160,109.538 C240.093,117.208 223.391,114.533 211.995,118.582 C204.293,122.937 196.589,127.292 188.887,131.646 C188.552,134.996 188.217,138.346 187.882,141.696 C180.603,143.984 176.794,148.338 171.807,152.750 C162.095,152.750 152.381,152.750 142.670,152.750 C144.814,138.677 141.003,133.625 137.646,121.597 C137.311,121.597 136.976,121.597 136.642,121.597 C135.302,124.277 133.962,126.957 132.623,129.637 C136.113,135.403 140.492,139.559 141.665,147.725 C140.995,149.400 140.325,151.075 139.656,152.750 C122.300,152.383 54.545,149.388 49.231,157.775 C45.436,163.783 46.967,179.518 47.222,188.928 C40.524,187.923 33.825,186.918 27.127,185.913 C27.127,186.248 27.127,186.583 27.127,186.918 C33.825,190.267 40.524,193.618 47.222,196.967 C47.222,201.656 47.222,206.347 47.222,211.036 C28.469,213.932 4.684,226.921 1.005,245.204 C0.670,245.204 0.335,245.204 -0.000,245.204 C-0.000,163.477 -0.000,81.726 -0.000,0.000 ZM639.000,0.000 C639.000,203.646 639.000,407.354 639.000,611.000 C549.589,610.665 460.151,610.330 370.741,609.995 C393.227,606.021 396.204,579.094 389.830,553.719 C382.268,523.616 368.018,490.884 359.689,452.220 C360.024,452.220 360.359,452.220 360.693,452.220 C361.028,452.890 361.363,453.560 361.698,454.230 C372.414,474.662 383.133,495.100 393.849,515.531 C409.993,504.290 431.090,455.364 431.024,428.102 C451.818,428.419 555.314,431.385 560.632,423.077 C567.045,412.449 562.800,310.223 562.642,288.416 C567.283,286.323 570.440,285.022 572.689,280.377 C569.340,281.381 565.990,282.387 562.642,283.391 C562.976,253.581 563.311,223.762 563.646,193.952 C596.625,185.529 585.166,140.347 631.967,136.671 C631.967,138.011 631.967,139.351 631.967,140.691 C625.604,144.710 619.240,148.731 612.877,152.750 C612.877,153.085 612.877,153.420 612.877,153.755 C626.038,152.429 630.970,144.945 637.995,137.676 C637.995,136.336 637.995,134.996 637.995,133.656 C615.110,119.997 577.533,164.674 562.642,173.854 C563.944,126.466 515.064,151.640 483.269,152.750 C478.206,131.689 462.742,144.997 451.118,135.666 C449.113,134.057 451.312,130.803 448.104,129.637 C440.737,130.306 433.367,130.976 426.000,131.646 C426.000,131.311 426.000,130.976 426.000,130.641 C466.935,120.257 510.306,64.132 480.255,16.079 C462.982,12.070 439.252,9.659 427.005,0.000 C497.663,0.000 568.342,0.000 639.000,0.000 ZM442.075,23.113 C443.080,23.113 444.085,23.113 445.090,23.113 C480.852,49.723 458.378,94.262 429.014,109.538 C416.796,106.891 411.044,104.027 400.882,95.469 C400.882,95.134 400.882,94.799 400.882,94.464 C401.552,94.129 402.222,93.794 402.892,93.459 C412.214,93.073 418.668,90.918 421.981,96.474 C427.832,94.595 440.336,83.306 439.061,74.365 C436.382,74.030 433.703,73.695 431.024,73.360 C431.024,72.355 431.024,71.350 431.024,70.345 C437.386,65.321 443.751,60.296 450.113,55.271 C450.312,49.069 450.018,47.012 447.099,44.217 C449.075,49.030 449.293,52.797 447.099,57.281 C427.892,60.692 425.989,89.946 406.910,73.360 C401.266,73.931 395.059,77.891 389.830,78.385 C385.377,78.806 377.746,74.641 366.722,76.375 C367.057,73.695 367.392,71.015 367.726,68.336 C366.387,68.336 365.047,68.336 363.708,68.336 C364.712,66.996 365.717,65.656 366.722,64.316 C377.103,57.282 387.487,50.246 397.868,43.212 C412.602,36.513 427.341,29.812 442.075,23.113 ZM285.340,428.102 C285.663,452.521 296.152,451.966 303.425,466.289 C303.759,466.289 304.094,466.289 304.429,466.289 C304.764,462.940 305.099,459.590 305.434,456.240 C306.773,457.245 308.113,458.250 309.453,459.255 C315.869,478.435 333.637,489.613 343.613,505.482 C351.065,517.334 355.270,538.648 360.693,550.704 C370.551,572.618 353.489,590.289 368.731,611.000 C245.833,611.000 122.898,611.000 -0.000,611.000 C0.335,489.415 0.670,367.794 1.005,246.209 C1.005,246.879 1.005,247.549 1.005,248.219 C3.684,252.573 6.363,256.929 9.042,261.283 C18.563,273.926 42.008,282.697 47.222,298.465 C47.222,318.227 47.222,337.995 47.222,357.757 C29.880,361.735 24.000,377.758 18.085,392.929 C18.755,393.264 19.425,393.599 20.094,393.934 C29.523,387.712 38.223,379.547 47.222,373.836 C46.736,388.115 43.226,420.503 52.245,426.092 C60.037,430.951 81.861,428.350 93.439,428.102 C85.282,442.703 73.066,454.118 67.316,471.314 C89.164,460.650 112.868,446.378 134.632,437.146 C134.632,437.481 134.632,437.816 134.632,438.151 C130.740,450.999 133.725,465.940 139.656,476.339 C152.661,475.886 156.306,469.979 167.788,468.299 C184.647,465.833 194.389,476.020 207.976,477.344 C222.095,468.460 232.217,463.218 236.108,444.181 C236.443,438.822 236.778,433.461 237.113,428.102 C237.113,428.772 237.113,429.442 237.113,430.112 C239.792,434.801 242.472,439.492 245.151,444.181 C246.156,443.176 247.160,442.171 248.165,441.166 C253.713,438.700 257.207,434.100 259.217,428.102 C267.924,428.102 276.633,428.102 285.340,428.102 Z&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>网页CSS代码</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span>,<span class="selector-tag">body</span>&#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">body</span>&#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">win.png</span>) no-repeat <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>网页js代码</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> win = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>).remote.getCurrentWindow()</span><br><span class="line"><span class="keyword">const</span> el = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;myPath&#x27;</span>)</span><br><span class="line">el.addEventListener(<span class="string">&#x27;mouseenter&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  win.setIgnoreMouseEvents(<span class="literal">true</span>, &#123; <span class="attr">forward</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">el.addEventListener(<span class="string">&#x27;mouseleave&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  win.setIgnoreMouseEvents(<span class="literal">false</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>


<h1 id="photoshop生成SVG-path代码"><a href="#photoshop生成SVG-path代码" class="headerlink" title="photoshop生成SVG path代码"></a>photoshop生成SVG path代码</h1><p>photoshop可以把形状直接复制出SVG代码，实现形状图层有以下两种方法：<br><strong>方法一：</strong>选择钢笔工具，类型选择形状，新建一个图层绘制对应的形状，在该图层上点击右键“复制SVG”<br><strong>方法二：</strong>选区选中透明区域，把选区转为路径，在画布上右键“定义自定形状”；工具栏选择“自定形状工具”，类型选择形状，再选择对应的自制自定义图形，插入到图层中，图层右键“复制SVG”</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2021/02/27/Electron%E4%B9%8B%E8%BF%9C%E7%A8%8B%E9%A1%B5%E9%9D%A2%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/27/Electron%E4%B9%8B%E8%BF%9C%E7%A8%8B%E9%A1%B5%E9%9D%A2%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5/" class="post-title-link" itemprop="url">Electron之远程页面代码注入</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-02-27 16:51:45 / 修改时间：16:52:40" itemprop="dateCreated datePublished" datetime="2021-02-27T16:51:45+08:00">2021-02-27</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Electron/" itemprop="url" rel="index"><span itemprop="name">Electron</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)  </span><br><span class="line"><span class="keyword">const</span> win = <span class="keyword">new</span> BrowserWindow()</span><br><span class="line">win.loadURL(<span class="string">&#x27;http://www.baidu.com&#x27;</span>)</span><br><span class="line">win.webContents.on(<span class="string">&quot;did-finish-load&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 直接注入CSS代码</span></span><br><span class="line">  win.webContents.insertCSS(<span class="string">&quot;body&#123;border:10px solid red !important;&#125;&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 注入CSS文件</span></span><br><span class="line">  <span class="keyword">const</span> css = fs.readFileSync(path.join(__dirname, <span class="string">&#x27;./insertCss.css&#x27;</span>)).toString();</span><br><span class="line">  win.webContents.insertCSS(css);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 直接注入JS代码</span></span><br><span class="line">  win.webContents.executeJavaScript(<span class="string">&#x27;alert(&quot;test&quot;);&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 注入JS文件</span></span><br><span class="line">  <span class="keyword">const</span> js = fs.readFileSync(path.join(__dirname, <span class="string">&#x27;./insertJs.js&#x27;</span>)).toString();</span><br><span class="line">  win.webContents.executeJavaScript(js);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 在渲染进程焦点位置输入内容，如文本框</span></span><br><span class="line">  win.webContents.insertText(<span class="string">&quot;test&quot;</span>)</span><br><span class="line">  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2021/02/27/Electron%E4%B9%8B%E5%AE%89%E8%A3%85%E7%95%8C%E9%9D%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/27/Electron%E4%B9%8B%E5%AE%89%E8%A3%85%E7%95%8C%E9%9D%A2/" class="post-title-link" itemprop="url">Electron之安装界面</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-02-27 14:25:44 / 修改时间：15:30:43" itemprop="dateCreated datePublished" datetime="2021-02-27T14:25:44+08:00">2021-02-27</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Electron/" itemprop="url" rel="index"><span itemprop="name">Electron</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Electron开发的应用默认安装界面较简洁，无法选择安装路径，一般在桌面应用开发过程中需要更丰富的安装功能，如展示使用协议、选择安装目录、选择安装组件等，安装成功后执行哪些操作等等。<br>下方以Electron+Vue项目为例，使用electron-builder+nsis自定义打包界面。</p>
<h1 id="在vue-config-js中配置NSIS，救命代码如下："><a href="#在vue-config-js中配置NSIS，救命代码如下：" class="headerlink" title="在vue.config.js中配置NSIS，救命代码如下："></a>在vue.config.js中配置NSIS，救命代码如下：</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// 第三方插件配置</span></span><br><span class="line">  pluginOptions: &#123;</span><br><span class="line">    <span class="comment">// vue-cli-plugin-electron-builder配置</span></span><br><span class="line">    electronBuilder: &#123;</span><br><span class="line">      builderOptions: &#123;</span><br><span class="line">        win: &#123;</span><br><span class="line">          icon: <span class="string">&#x27;public/logo.ico&#x27;</span>,</span><br><span class="line">          <span class="comment">// 图标路径 windows系统中icon需要256*256的ico格式图片，更换应用图标亦在此处</span></span><br><span class="line">          target: [&#123;</span><br><span class="line">            <span class="comment">// 打包成一个独立的 exe 安装程序</span></span><br><span class="line">            target: <span class="string">&#x27;nsis&#x27;</span>,</span><br><span class="line">            <span class="comment">// 这个意思是打出来32 bit + 64 bit的包，但是要注意：这样打包出来的安装包体积比较大，所以建议直接打32的安装包。</span></span><br><span class="line">            <span class="string">&#x27;arch&#x27;</span>: [</span><br><span class="line">              <span class="string">&#x27;x64&#x27;</span></span><br><span class="line">              <span class="comment">// &#x27;ia32&#x27;</span></span><br><span class="line">            ]</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;,</span><br><span class="line">        dmg: &#123;</span><br><span class="line">          <span class="string">&#x27;contents&#x27;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="string">&#x27;x&#x27;</span>: <span class="number">410</span>,</span><br><span class="line">              <span class="string">&#x27;y&#x27;</span>: <span class="number">150</span>,</span><br><span class="line">              <span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;link&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;/Applications&#x27;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="string">&#x27;x&#x27;</span>: <span class="number">130</span>,</span><br><span class="line">              <span class="string">&#x27;y&#x27;</span>: <span class="number">150</span>,</span><br><span class="line">              <span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;file&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line">        linux: &#123;</span><br><span class="line">          icon: <span class="string">&#x27;public/logo.ico&#x27;</span>,</span><br><span class="line">          target: <span class="string">&#x27;AppImage&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        mac: &#123;</span><br><span class="line">          icon: <span class="string">&#x27;public/logo.ico&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        files: [<span class="string">&#x27;**/*&#x27;</span>],</span><br><span class="line">        asar: <span class="literal">false</span>,</span><br><span class="line">        nsis: &#123;</span><br><span class="line">          <span class="string">&quot;include&quot;</span>: <span class="string">&quot;public/nim/nim_setup.nsi&quot;</span>,</span><br><span class="line">          <span class="comment">// 是否一键安装，建议为 false，可以让用户点击下一步、下一步、下一步的形式安装程序，如果为true，当用户双击构建好的程序，自动安装程序并打开，即：一键安装（one-click installer）</span></span><br><span class="line">          oneClick: <span class="literal">false</span>,</span><br><span class="line">          <span class="comment">// 允许请求提升。 如果为false，则用户必须使用提升的权限重新启动安装程序。</span></span><br><span class="line">          allowElevation: <span class="literal">true</span>,</span><br><span class="line">          <span class="comment">// 允许修改安装目录，建议为 true，是否允许用户改变安装目录，默认是不允许</span></span><br><span class="line">          allowToChangeInstallationDirectory: <span class="literal">true</span>,</span><br><span class="line">          <span class="comment">// 安装图标</span></span><br><span class="line">          installerIcon: <span class="string">&#x27;public/logo.ico&#x27;</span>,</span><br><span class="line">          <span class="comment">// 卸载图标</span></span><br><span class="line">          uninstallerIcon: <span class="string">&#x27;public/logo.ico&#x27;</span>,</span><br><span class="line">          <span class="comment">// 安装时头部图标</span></span><br><span class="line">          installerHeaderIcon: <span class="string">&#x27;public/logo.ico&#x27;</span>,</span><br><span class="line">          <span class="comment">// 创建桌面图标</span></span><br><span class="line">          createDesktopShortcut: <span class="literal">true</span>,</span><br><span class="line">          <span class="comment">// 创建开始菜单图标</span></span><br><span class="line">          createStartMenuShortcut: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      chainWebpackMainProcess: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">        config.plugin(<span class="string">&#x27;define&#x27;</span>).tap(<span class="function"><span class="params">args</span> =&gt;</span> &#123;</span><br><span class="line">          args[ <span class="number">0</span> ][ <span class="string">&#x27;IS_ELECTRON&#x27;</span> ] = <span class="literal">true</span></span><br><span class="line">          <span class="keyword">return</span> args</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">      chainWebpackRendererProcess: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">        config.plugin(<span class="string">&#x27;define&#x27;</span>).tap(<span class="function"><span class="params">args</span> =&gt;</span> &#123;</span><br><span class="line">          args[ <span class="number">0</span> ][ <span class="string">&#x27;IS_ELECTRON&#x27;</span> ] = <span class="literal">true</span></span><br><span class="line">          <span class="keyword">return</span> args</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;,</span><br><span class="line">      outputDir: <span class="string">&#x27;dist&#x27;</span>,</span><br><span class="line">      <span class="comment">// mainProcessFile: &#x27;src/main.js&#x27;,</span></span><br><span class="line">      <span class="comment">// mainProcessWatch: [&#x27;src/main&#x27;]</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>注意： window下图标需为ico或png格式且不小于256*256<br>参考资料 <a target="_blank" rel="noopener" href="https://www.electron.build/icons.html#windows-nsis">https://www.electron.build/icons.html#windows-nsis</a></p>
<h1 id="使用NSIS自定义安装界面"><a href="#使用NSIS自定义安装界面" class="headerlink" title="使用NSIS自定义安装界面"></a>使用NSIS自定义安装界面</h1><p>NSIS简界代码示例：</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">nsis文件中配置安装界面相关信息（可通过nsis安装界面开发工具开发），nsi文件示例：</span><br><span class="line"><span class="comment">; HM NIS Edit Wizard helper defines</span></span><br><span class="line">!include <span class="string">&quot;MUI2.nsh&quot;</span></span><br><span class="line"><span class="comment">; ; MUI Settings</span></span><br><span class="line">!define MUI_ABORTWARNING</span><br><span class="line"><span class="comment">; 欢迎页面</span></span><br><span class="line">!<span class="keyword">insertmacro </span>MUI_PAGE_WELCOME</span><br><span class="line"><span class="keyword">ShowInstDetails </span><span class="keyword">show</span></span><br><span class="line"><span class="keyword">ShowUnInstDetails </span><span class="keyword">show</span></span><br><span class="line"><span class="keyword">SpaceTexts </span><span class="keyword">show</span></span><br><span class="line"><span class="keyword">; </span>安装脚本</span><br><span class="line">!macro customInstall</span><br><span class="line">!macroend</span><br></pre></td></tr></table></figure>

<h1 id="NSIS界面开发"><a href="#NSIS界面开发" class="headerlink" title="NSIS界面开发"></a>NSIS界面开发</h1><h2 id="使用NSIS和HM-NIS-Edit生成NSIS文件"><a href="#使用NSIS和HM-NIS-Edit生成NSIS文件" class="headerlink" title="使用NSIS和HM NIS Edit生成NSIS文件"></a>使用NSIS和HM NIS Edit生成NSIS文件</h2><p>NSIS下载地址：<a target="_blank" rel="noopener" href="https://nsis.sourceforge.io/Download">https://nsis.sourceforge.io/Download</a><br>HM NIS Edit下载地址：<a target="_blank" rel="noopener" href="http://hmne.sourceforge.net/">http://hmne.sourceforge.net</a><br><strong>使用步骤</strong><br>1、打开HM NIS Edit，通过新建向导生成NSIS文件<br><img src="/img/2021-2-27/nsis01.png"><br><img src="/img/2021-2-27/nsis02.png"><br>2、填写应用相关信息<br><img src="/img/2021-2-27/nsis03.png"><br>3、选择语言及协议文件<br><img src="/img/2021-2-27/nsis04.png"><br><img src="/img/2021-2-27/nsis05.png"><br>4、选择应用打包目录，electron build生成的目录，对应out/win-unpacked<br><img src="/img/2021-2-27/nsis06.png"><br><img src="/img/2021-2-27/nsis07.png"><br><img src="/img/2021-2-27/nsis08.png"><br><img src="/img/2021-2-27/nsis09.png"><br><img src="/img/2021-2-27/nsis10.png"><br><img src="/img/2021-2-27/nsis11.png"><br><img src="/img/2021-2-27/nsis12.png"><br><img src="/img/2021-2-27/nsis13.png"><br><img src="/img/2021-2-27/nsis14.png"></p>
<p>参考资料： <a target="_blank" rel="noopener" href="https://lihefei.blog.csdn.net/article/details/108797377">https://lihefei.blog.csdn.net/article/details/108797377</a></p>
<h2 id="牛牛安装界面控件"><a href="#牛牛安装界面控件" class="headerlink" title="牛牛安装界面控件"></a>牛牛安装界面控件</h2><p>牛牛安装界面控件是一款安装包UI控制，可自定义安装皮肤界面。<br>1、下载牛牛安装界面控件<br><a target="_blank" rel="noopener" href="http://www.ggniu.cn/download.htm">http://www.ggniu.cn/download.htm</a><br>2、修改包里对应的NSIS配置项，配置在SetupScripts目录下<br>3、把生成的electron文件放到FilesToInstall目录<br>4、运行build-nim-nozip.bat进行打包，最终输出exe文件到Output目录</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2018/03/15/vue%E5%8D%95%E9%9D%A2%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/03/15/vue%E5%8D%95%E9%9D%A2%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5/" class="post-title-link" itemprop="url">vue单面应用实践</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-03-15 22:09:19" itemprop="dateCreated datePublished" datetime="2018-03-15T22:09:19+08:00">2018-03-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-05-16 15:54:26" itemprop="dateModified" datetime="2021-05-16T15:54:26+08:00">2021-05-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Vue/" itemprop="url" rel="index"><span itemprop="name">Vue</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="使用vue-cli初始化项目-vue-cli为vue的构建工具，默认配置里已结合webpack-vue-router-babel"><a href="#使用vue-cli初始化项目-vue-cli为vue的构建工具，默认配置里已结合webpack-vue-router-babel" class="headerlink" title="使用vue-cli初始化项目(vue-cli为vue的构建工具，默认配置里已结合webpack/vue-router/babel)"></a>使用vue-cli初始化项目(vue-cli为vue的构建工具，默认配置里已结合webpack/vue-router/babel)</h1><p><a target="_blank" rel="noopener" href="https://vuejs-templates.github.io/webpack/">https://vuejs-templates.github.io/webpack/</a><br>$ npm install -g vue-cli<br>$ vue init webpack my-project<br>$ cd my-project<br>$ npm install<br>$ npm run dev</p>
<p>查看vue-cli是否安装成功(V需大写)：vue -V    </p>
<p>如npm install失败可切换到淘宝镜像使用cnpm安装：<br>npm install -g cnpm –registry=<a target="_blank" rel="noopener" href="https://registry.npm.taobao.org/">https://registry.npm.taobao.org</a><br>cnpm i</p>
<p>运行项目：npm run dev</p>
<p>使用插件：vue+webpack+vue-router+axios+mockjs</p>
<h1 id="添加less"><a href="#添加less" class="headerlink" title="添加less"></a>添加less</h1><p>安装：npm install less less-loader –save-dev<br>使用<code>&lt;style lang=&quot;less&quot; scoped&gt;</code><br>引入less文件时行尾需加分号</p>
<h1 id="vue-router路由使用"><a href="#vue-router路由使用" class="headerlink" title="vue-router路由使用"></a>vue-router路由使用</h1><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line">Vue.use(Router)</span><br></pre></td></tr></table></figure>

<p>路由传参：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/detail/&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">&quot;&#123;name:&#x27;detail&#x27;,params: &#123;id: item.id&#125;&#125;&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">&quot;&#x27;/detail/&#x27;+item.id&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">&quot;&#123; path: &#x27;register&#x27;, query: &#123; plan: &#x27;private&#x27; &#125;&#125;&quot;</span>&gt;</span>Register<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在子组件中调用参数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.$route.params.id</span><br><span class="line">&#123;&#123;$route.params.id&#125;&#125;</span><br></pre></td></tr></table></figure>

<h1 id="axios的使用"><a href="#axios的使用" class="headerlink" title="axios的使用"></a>axios的使用</h1><p>安装npm install axios –save<br>import Vue from ‘vue’<br>import axios from ‘axios’<br>Vue.prototype.$axios = axios<br>使用：this.$axios.get(…).then(…).catch(…)</p>
<h1 id="模拟数据（mock-js）"><a href="#模拟数据（mock-js）" class="headerlink" title="模拟数据（mock.js）"></a>模拟数据（mock.js）</h1><p>1、安装：npm install mockjs –save-dev<br>2、建立模拟数据文件mockData.js(mock.js规则<a target="_blank" rel="noopener" href="http://mockjs.com/examples.html)%EF%BC%9B">http://mockjs.com/examples.html)；</a><br>3、在入口文件里配置开发环境引入mock数据，生产环境不引用，另添加开发环境下在控制台打印JSON数据</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">&#x27;development&#x27;</span>) &#123;</span><br><span class="line">  <span class="built_in">require</span>(<span class="string">&#x27;./mockData&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4、正则模糊匹配url（适用带参数地址）<br>Mock.mock(new RegExp(AjaxApi.detail), DetailData)<br>5、模拟数据转为字符串并在控制台格式化输出<br>window.JSON.stringify(response.data,null,2)   // 在webpack中打包使用时需加window前缀</p>
<h1 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h1><p>.vue文件中通过img标签引用图片可直接使用相对路径<br>样式中使用图片，使用相对路径，在build/webpack.base.conf.js中配置，当图片小于10000kb时会使用base64</p>
<h1 id="Eslint配置"><a href="#Eslint配置" class="headerlink" title="Eslint配置"></a>Eslint配置</h1><p>关闭eslint：build/webpack.base.conf.js 配置文件中的eslint rules注释掉即可</p>
<p>.eslintrc.js配置自定义规则：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// allow paren-less arrow functions</span></span><br><span class="line"><span class="string">&#x27;arrow-parens&#x27;</span>: <span class="number">0</span>,</span><br><span class="line"><span class="comment">// allow async-await</span></span><br><span class="line"><span class="string">&#x27;generator-star-spacing&#x27;</span>: <span class="number">0</span>,</span><br><span class="line"><span class="comment">// allow debugger during development</span></span><br><span class="line"><span class="string">&#x27;no-debugger&#x27;</span>: process.env.NODE_ENV === <span class="string">&#x27;production&#x27;</span> ? <span class="number">2</span> : <span class="number">0</span>,</span><br><span class="line"><span class="string">&quot;no-unused-vars&quot;</span>: [<span class="number">2</span>, &#123;</span><br><span class="line">  <span class="comment">// 允许声明未使用变量</span></span><br><span class="line">  <span class="string">&quot;vars&quot;</span>: <span class="string">&quot;local&quot;</span>,</span><br><span class="line">  <span class="comment">// 参数不检查</span></span><br><span class="line">  <span class="string">&quot;args&quot;</span>: <span class="string">&quot;none&quot;</span></span><br><span class="line">&#125;],</span><br><span class="line"><span class="comment">// 关闭语句强制分号结尾</span></span><br><span class="line"><span class="string">&quot;semi&quot;</span>: [<span class="number">0</span>],</span><br><span class="line"><span class="comment">//空行最多不能超过100行</span></span><br><span class="line"><span class="string">&quot;no-multiple-empty-lines&quot;</span>: [<span class="number">0</span>, &#123;<span class="string">&quot;max&quot;</span>: <span class="number">100</span>&#125;],</span><br><span class="line"><span class="comment">//关闭禁止混用tab和空格</span></span><br><span class="line"><span class="string">&quot;no-mixed-spaces-and-tabs&quot;</span>: [<span class="number">0</span>],</span><br><span class="line"><span class="comment">// 关闭行尾不能有空格</span></span><br><span class="line"><span class="string">&quot;no-trailing-spaces&quot;</span>: <span class="number">0</span>,</span><br></pre></td></tr></table></figure>
<h1 id="七、代码懒加载"><a href="#七、代码懒加载" class="headerlink" title="七、代码懒加载"></a>七、代码懒加载</h1><p>1、添加 syntax-dynamic-import 插件(<a target="_blank" rel="noopener" href="https://babeljs.io/docs/plugins/syntax-dynamic-import/">https://babeljs.io/docs/plugins/syntax-dynamic-import/</a>)<br>2、.babelrc里配置<br>{“plugins”: [“syntax-dynamic-import”]}<br>3、页面引用<br>const detail = () =&gt; import(‘@/components/detail’)<br>或者多个<br>const detail = () =&gt; import(/* webpackChunkName: “detail” <em>/ ‘@/components/detail’)<br>const about = () =&gt; import(/</em> webpackChunkName: “detail” */ ‘@/components/about’)</p>
<p>另外需在webpack.base.conf.js是配置生成的路径及文件名</p>
<h1 id="路由切换返回回到原滚动位置"><a href="#路由切换返回回到原滚动位置" class="headerlink" title="路由切换返回回到原滚动位置"></a>路由切换返回回到原滚动位置</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">  routes: [...],</span><br><span class="line">  scrollBehavior (to, <span class="keyword">from</span>, savedPosition) &#123;</span><br><span class="line">    <span class="comment">// return 期望滚动到哪个的位置</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>如果列表页数据是通过上拉加载，可通过vuex进行数据管理并在跳转时记录列表页滚动条位置，参考<a target="_blank" rel="noopener" href="http://www.cnblogs.com/buerjj/p/8405443.html">http://www.cnblogs.com/buerjj/p/8405443.html</a><br>实现方法：<br>1、通过vuex记录动态加载的列表数据indexItems，页面跳转时记录滚动条位置pageYOffset, 是否目标页面返回isFromDetail（在路由中beforeRouteEnter修改状态）<br>2、列表页重新加载时判断indexItems是否大于0及isFromDetail为true时，从indexItems读取数据，并跳转滚动条到指定位置</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2018/01/29/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%99%90%E5%88%B6%E6%96%87%E6%9C%AC%E6%A1%86%E8%BE%93%E5%85%A5%E4%B8%BA%E6%95%B4%E6%95%B0%E6%88%96%E4%B8%A4%E4%BD%8D%E5%B0%8F%E6%95%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/01/29/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%99%90%E5%88%B6%E6%96%87%E6%9C%AC%E6%A1%86%E8%BE%93%E5%85%A5%E4%B8%BA%E6%95%B4%E6%95%B0%E6%88%96%E4%B8%A4%E4%BD%8D%E5%B0%8F%E6%95%B0/" class="post-title-link" itemprop="url">移动端限制文本框输入为整数或两位小数</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-01-29 21:35:13" itemprop="dateCreated datePublished" datetime="2018-01-29T21:35:13+08:00">2018-01-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2018-04-15 22:07:41" itemprop="dateModified" datetime="2018-04-15T22:07:41+08:00">2018-04-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一、测试环境："><a href="#一、测试环境：" class="headerlink" title="一、测试环境："></a>一、测试环境：</h1><blockquote>
<p>华为荣耀6原生浏览器：chrome30<br>安卓QQ浏览器：chrome37<br>安卓微信：chrome57<br>安卓搜狗浏览器：chrome46<br>安卓UC：chrome57<br>iphone5s 10.3.2<br>ipad 9.3.2</p>
</blockquote>
<h1 id="二、type-”number”表现形式："><a href="#二、type-”number”表现形式：" class="headerlink" title="二、type=”number”表现形式："></a>二、type=”number”表现形式：</h1><blockquote>
<p>华为原生浏览器、QQ浏览器、iphone原生浏览器（iphone微信浏览器）: 获得焦点后调用全数字键盘，可输入数字、中文及任意符号，输入法可切换，可粘贴所有字符<br>android微信、安卓搜狗、安卓UC：调用数字键盘，只可输入0-9数字、小数点、加减号、e，粘贴时会对内容进行过滤只显示合法字符<br>ipad：调用全数字键盘，可输入任意字符</p>
</blockquote>
<h1 id="三、type-”number”和pattern-”-0-9-”一起使用时表现形式："><a href="#三、type-”number”和pattern-”-0-9-”一起使用时表现形式：" class="headerlink" title="三、type=”number”和pattern=”[0-9]*”一起使用时表现形式："></a>三、type=”number”和pattern=”[0-9]*”一起使用时表现形式：</h1><blockquote>
<p>安卓下效果与没有pattern时一致<br>iphone5s:调用九格宫数字键盘，不可切换输入法，只可输入0-9数字，可粘贴所有字符<br>ipad：调用全数字键盘，可输入任意字符</p>
</blockquote>
<h1 id="四、type-”text”和pattern-”-0-9-”一起使用时表现形式："><a href="#四、type-”text”和pattern-”-0-9-”一起使用时表现形式：" class="headerlink" title="四、type=”text”和pattern=”[0-9]*”一起使用时表现形式："></a>四、type=”text”和pattern=”[0-9]*”一起使用时表现形式：</h1><blockquote>
<p>安卓：调用全键盘，可输入任何字符，在表单触发submit事件时验证pattern规则<br>iphone5s：调用九格宫数字键盘，不可切换输入法，只可输入0-9数字，可粘贴所有字符<br>ipad：调用全数字键盘，可输入任意字符</p>
</blockquote>
<div class="remark">** 注：**
1、IOS中，只有[0-9]*才可以调起九宫格数字键盘，\d 无效；
2、pattern属性适用于以下 `<input>` 类型：text, search, url, telepone, email 以及 password。所以number文本框的pattern属性的规则是无效的，它遵循的是number的规则，唯一的作用是可以在IOS下调起九宫格数字键盘。
</div>

<h1 id="五、限制只能输入整数（与zepto同用）"><a href="#五、限制只能输入整数（与zepto同用）" class="headerlink" title="五、限制只能输入整数（与zepto同用）"></a>五、限制只能输入整数（与zepto同用）</h1><pre><code class="html">&lt;input type=&quot;number&quot; pattern=&quot;[0-9]*&quot; value=&quot;&quot; class=&quot;set-input-int&quot;  placeholder=&quot;number整数&quot; /&gt;
</code></pre>
<pre><code class="javascript">$.fn.formatInt=function()&#123;
    var target=this;
    function verify(e)&#123;
        //console.log(e.keyCode)
        //if(e.keyCode==69 || e.keyCode==189 || e.keyCode==187)return false;   // 安卓下number可输入除数字外还可输&quot;+-e&quot;，过滤&quot;+-e&quot;,PC有效移动端无效
        var val=$(this).val();
        val=val.replace(/[^\d]/g,&#39;&#39;);
        val= isNaN(parseInt(val))?&#39;&#39;:parseInt(val);
        $(this).val(&#39;&#39;).val(val)     // 安卓下number里‘.’无法过滤掉，所以先清空
    &#125;
    target.on(&#39;keyup&#39;,verify)
    target.on(&#39;blur&#39;,verify)           
&#125;
$(&#39;.set-input-int&#39;).formatInt();
</code></pre>
<div class="remark">** 备注：**
1、android type="number"输入"+-e"会清空文本框内容，使用text不存在这个问题，但是text无法直接调用数字键盘
2、iphone5S和ipad下通过粘贴输入的非数字会清空
3、android chrome30/37，类似parseInt('343sds')会返回NaN，所有返回NaN的做清空处理
</div>

<h1 id="六、限制最多可输入两位小数（与zepto同用）"><a href="#六、限制最多可输入两位小数（与zepto同用）" class="headerlink" title="六、限制最多可输入两位小数（与zepto同用）"></a>六、限制最多可输入两位小数（与zepto同用）</h1><pre><code class="html">&lt;input type=&quot;text&quot; value=&quot;&quot; class=&quot;set-input-tofixed&quot; placeholder=&quot;input两位小数&quot; /&gt;
&lt;input type=&quot;number&quot; value=&quot;&quot; class=&quot;set-input-tofixed&quot; placeholder=&quot;number两位小数&quot; /&gt;
</code></pre>
<pre><code class="javascript">$.fn.formatToFixed=function(opt)&#123;
    var target=this;
    function verify()&#123;
        var val=$(this).val();
        val=val.replace(/[^\d+\.]/g,&#39;&#39;); 
        // 只输入数字和点
        if(val!=&#39;&#39;)&#123;
            if(val.indexOf(&#39;.&#39;)&gt;=0)&#123;
                var arr=val.split(&#39;.&#39;);
                val=arr.length&gt;2?parseFloat(val):val;
                val=arr[1].length&gt;opt?parseFloat(val).toFixed(opt):val;
            &#125;else&#123;
                val=parseFloat(val);
            &#125;
        &#125;
        $(this).val(val)
    &#125;
    target.on(&#39;keyup&#39;,verify)
    target.on(&#39;blur&#39;,verify)
&#125;
$(&#39;.set-input-tofixed&#39;).formatToFixed(2);
</code></pre>
<div class="remark"> ** 备注：**
1、设置pattern="[0-9]*"会导致IOS下不能输入小数点，text不能直接调起数字键盘，number可以调起全数字键盘，
2、安卓微信下number存在“+-e”导致的清空内容问题，chrome30/37、iphone5s、ipad下number验证异常时都会清空文本框内容（如输入字母或符号），使用text IOS和安卓不存在这个问题，但是用户体验不好。
</div>

<p>　　关于input type=”number”的取值问题：在IOS及安卓下低版本的chrome（30/37）下可输入任意字符，当取的值为非合法数字时会返回空，安卓高版本的浏览器下只可输入“+-e.”及数字，当为非合法数字时取值也返回空。</p>
<p>另外下面方法在PC上有效，移动端无效：</p>
<pre><code>&lt;input type=&quot;number&quot; onkeypress=&quot;return (/[\d]/.test(String.fromCharCode(event.keyCode)))&quot; /&gt;
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2016/05/08/chrome%20background%20tab%E6%83%85%E5%86%B5%E4%B8%8BsetTimeout%E3%80%81setInterval%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/05/08/chrome%20background%20tab%E6%83%85%E5%86%B5%E4%B8%8BsetTimeout%E3%80%81setInterval%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6/" class="post-title-link" itemprop="url">chrome background tab情况下setTimeout、setInterval渲染机制问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2016-05-08 21:33:44 / 修改时间：23:00:32" itemprop="dateCreated datePublished" datetime="2016-05-08T21:33:44+08:00">2016-05-08</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>　　chrome下，当把标签页切换到非活动状态下（background tab）,被切换的页面里执行的setTimeout/setInterval会发生混乱。在做倒计时时由于执行的频率较少，以为标签非活动状态下会停止setTimeout/setIntervaql的执行，测试证明chrome并没有停止计时器的执行，而只是针对执行时间小于1000ms的定时器减缓其执行频率，定时器间隔时间越小减缓强度越大。</p>
<blockquote>
<p>In early 2011, both Firefox and Chrome clamped the minimum wait time for setTimeout and setInterval to one second when running in a tab that is not the active tab for its window. <a target="_blank" rel="noopener" href="https://blog.pivotal.io/pivotal-labs/labs/chrome-and-firefox-throttle-settimeout-setinterval-in-inactive-tabs">查看原文</a></p>
</blockquote>
<p>以下为约一个小时的background tab页里setInterval的测试数据：<br><img src="/img/2016-5-8/test.png" alt="测试结果"></p>
<p>测试代码：</p>
<pre><code>&lt;!DOCTYPE HTML&gt; 
&lt;html&gt; 
&lt;head&gt; 
&lt;meta charset=&quot;utf-8&quot;&gt; 
&lt;title&gt;&lt;/title&gt; 
&lt;style type=&quot;text/css&quot;&gt;
strong&#123;color:#FF0000;font-weight:bold;display:inline-block;width:60px;text-align:right;margin-right:5px;&#125;
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div&gt;&lt;strong&gt;1000ms:&lt;/strong&gt;&lt;span id=&quot;a&quot;&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;strong&gt;999ms:&lt;/strong&gt;&lt;span id=&quot;g&quot;&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;strong&gt;500ms:&lt;/strong&gt;&lt;span id=&quot;b&quot;&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;strong&gt;250ms:&lt;/strong&gt;&lt;span id=&quot;f&quot;&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;strong&gt;100ms:&lt;/strong&gt;&lt;span id=&quot;c&quot;&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div id=&quot;d&quot;&gt;&lt;/div&gt;
&lt;div&gt;&lt;strong&gt;10ms:&lt;/strong&gt;&lt;span id=&quot;e&quot;&gt;&lt;/span&gt;&lt;/div&gt;

&lt;script src=&quot;jquery-1.11.3.min.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
var now=new Date();
var aa=bb=cc=dd=ee=ff=gg=0;
function a()&#123;
    $(&#39;#a&#39;).text(aa+=1000)
&#125;
function b()&#123;
    $(&#39;#b&#39;).text(bb+=500)
&#125;
function f()&#123;
    $(&#39;#f&#39;).text(ff+=250)
&#125;
function c()&#123;
    $(&#39;#c&#39;).text(cc+=100)
&#125;
function d()&#123;
    $(&#39;#d&#39;).text(dd+=50)
&#125;
 
function e()&#123;
    $(&#39;#e&#39;).text(ee+=10)
&#125;
function g()&#123;
    $(&#39;#g&#39;).text(gg+=999);
&#125;
 
setInterval(a,1000);
setInterval(c,100);
setInterval(e,10);
setInterval(f,250);
setInterval(b,500);
setInterval(g,999);
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;

</code></pre>
<h5 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h5><p><a target="_blank" rel="noopener" href="https://blog.pivotal.io/pivotal-labs/labs/chrome-and-firefox-throttle-settimeout-setinterval-in-inactive-tabs">chrome-and-firefox-throttle-settimeout-setinterval-in-inactive-tabs</a><br><a target="_blank" rel="noopener" href="https://developer.chrome.com/extensions/event_pages#transition">https://developer.chrome.com/extensions/event_pages#transition</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2016/03/26/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E8%BF%94%E5%9B%9E%E4%B8%8A%E4%B8%80%E9%A1%B5%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/03/26/%E7%A7%BB%E5%8A%A8%E7%AB%AF%E8%BF%94%E5%9B%9E%E4%B8%8A%E4%B8%80%E9%A1%B5%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%B3%95/" class="post-title-link" itemprop="url">移动端返回上一页实现方法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2016-03-26 14:33:44" itemprop="dateCreated datePublished" datetime="2016-03-26T14:33:44+08:00">2016-03-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2016-04-23 17:02:04" itemprop="dateModified" datetime="2016-04-23T17:02:04+08:00">2016-04-23</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一、问题描述"><a href="#一、问题描述" class="headerlink" title="一、问题描述:"></a>一、问题描述:</h1><p>　　使用window.history.go(-1)或者window.history.back(-1)实现移动端返回上一页功能，原生safair浏览器里存在问题（通过flex布局的上一张页面滚动无效，只能显示点击前停留的那屏，无法通过触摸滚动页面）。存在于ios 9.3(13E233)和ios9.3.1(13E238)系统,ios9.3其它版本未发现该问题，ios安装的其它浏览器不存在该问题，android也没有该问题。</p>
<h1 id="二、解决方案："><a href="#二、解决方案：" class="headerlink" title="二、解决方案："></a>二、解决方案：</h1><p>　　ios原生浏览器（ios其它浏览器不存在这种情况）下通过document.referrer实现返回上一页，部分手机的QQ内嵌浏览器使用document.referrer不能正常返回上一页，android下通过referrer属性实现时，当刷新页面后返回前一页失效，所以判断移动端浏览器类型针对原生safair进行处理，具体代码如下：</p>
<pre><code>&lt;a href=&quot;#&quot; id=&quot;goBack&quot; &gt;返回&lt;/a&gt;

var u = navigator.userAgent;
var goBack=document.getElementById(&quot;goBack&quot;);
//针对ios原生浏览器处理
if(!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/) &amp;&amp; /(Safari)/i.test(u))&#123;
    goBack.setAttribute(&quot;onclick&quot;,&quot;javascript:window.location=document.referrer;&quot;);
&#125;
</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://niniun1024.github.io/2016/02/24/chrome%E5%8F%96%E6%B6%88%E6%B5%8F%E8%A7%88%E5%99%A8%E8%87%AA%E5%8A%A8%E6%92%AD%E6%94%BEflash%E5%B9%BF%E5%91%8A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="niniun1024">
      <meta itemprop="description" content="niniun1024's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="niniun1024's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/02/24/chrome%E5%8F%96%E6%B6%88%E6%B5%8F%E8%A7%88%E5%99%A8%E8%87%AA%E5%8A%A8%E6%92%AD%E6%94%BEflash%E5%B9%BF%E5%91%8A/" class="post-title-link" itemprop="url">chrome取消浏览器自动播放flash广告</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2016-02-24 14:33:44" itemprop="dateCreated datePublished" datetime="2016-02-24T14:33:44+08:00">2016-02-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2016-04-23 17:24:51" itemprop="dateModified" datetime="2016-04-23T17:24:51+08:00">2016-04-23</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一、问题描述"><a href="#一、问题描述" class="headerlink" title="一、问题描述:"></a>一、问题描述:</h1><p>　　chrome 45及以上版本默认不自动播放flash，对于非自动播放的广告，chrome会在flash上悬浮一个播放按钮，点击后可播放。flash广告多使用覆盖a链接来实现，这种方法下无法点中chrome贴心提供的播放按钮。</p>
<p>** 不自动播放的flash需满足以下两点： **</p>
<ol>
<li>跨域</li>
<li>尺寸小于398*298（未知此尺寸chrome是怎么得出的）</li>
</ol>
<blockquote>
<p>** acelan86文中解决思路（<a target="_blank" rel="noopener" href="https://github.com/acelan86/whatthefuck/wiki/chrome-45%E4%BB%A5%E4%B8%8A%E4%B8%8D%E8%87%AA%E5%8A%A8%E6%92%AD%E6%94%BE%22%E9%9D%9E%E5%BF%85%E8%A6%81%22flash%E7%9A%84%E4%B8%80%E7%A7%8D%E5%8F%AF%E8%83%BD%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">文章链接</a>）： **<br>在flash渲染的时候暂时把尺寸设置成大于398*298，在实际展现的时候在设置回来。<br>这里的尺寸有几个注意点： </p>
<ol>
<li>不只是flash自己的尺寸而是真正展现的尺寸，有可能flash设置了足够大，但是它外面包含的容器overflow了，导致flash实际尺寸没有这么大，这样也是无法自动播放的 </li>
<li>经过尝试，opacity:0 的flash只要尺寸足够大，也是可以自动播放的</li>
</ol>
</blockquote>
<p>另外发现当flash能过定位设置在布局之外，再定时显示也可解决flash自动播放的问题。</p>
<h1 id="二、解决方案："><a href="#二、解决方案：" class="headerlink" title="二、解决方案："></a>二、解决方案：</h1><p>1、同域下flash不受限制<br>2、设置大于398*298的尺寸，在渲染完成后改回小尺寸(渲染时间不可控，渲染影响因素不明)，参考acelan86上文中方法<br>3、通过定位设置一个很大的left值（使flash不可见，一定时间后改回正常值，时间不可控）</p>
<p>其中2、3方法的具体写法：<br>（1）JS通过setTimeout设置<br>（2）针对webkit利用css animation设置：</p>
<pre><code>@media screen and (-webkit-min-device-pixel-ratio:0)&#123;
    .fixedFlashAutoStart&#123;
        position:relative;
        left:99999px;
        -webkit-animation:fixedFlashAutoPlay 1ms linear 500ms 1 forwards;
    &#125;
    @-webkit-keyframes fixedFlashAutoPlay&#123;
        from &#123;left:99999px;&#125;
        to &#123;left:0;&#125;
    &#125;
&#125;
</code></pre>
<h1 id="三、存在的问题："><a href="#三、存在的问题：" class="headerlink" title="三、存在的问题："></a>三、存在的问题：</h1><p>2、3定时重绘的方法非百分百有效，因所设置时间因素不可控（非flash下载时间，不确定是否是flash渲染时间）。</p>
<h5 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h5><p><a target="_blank" rel="noopener" href="https://github.com/acelan86/whatthefuck/wiki/chrome-45%E4%BB%A5%E4%B8%8A%E4%B8%8D%E8%87%AA%E5%8A%A8%E6%92%AD%E6%94%BE%22%E9%9D%9E%E5%BF%85%E8%A6%81%22flash%E7%9A%84%E4%B8%80%E7%A7%8D%E5%8F%AF%E8%83%BD%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88">chrome-45以上不自动播放”非必要”flash的一种可能解决方案</a><br><a target="_blank" rel="noopener" href="https://news.ycombinator.com/item?id=10133771">https://news.ycombinator.com/item?id=10133771</a><br><a target="_blank" rel="noopener" href="https://code.google.com/p/chromium/codesearch#chromium/src/content/renderer/pepper/plugin_power_saver_helper.cc&sq=package:chromium&type=cs&l=87">chromium source code see constants</a><br><a target="_blank" rel="noopener" href="https://code.google.com/p/chromium/codesearch#chromium/src/content/renderer/pepper/plugin_instance_throttler_impl.cc&q=plugin_instance_throttler_impl&sq=package:chromium&type=cs&l=5">chromium source code See ShouldThrottleConten</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">niniun1024</p>
  <div class="site-description" itemprop="description">niniun1024's blog</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">20</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">niniun1024</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
